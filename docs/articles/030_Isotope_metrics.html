<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>#2: Compute niche metrics â€¢ AmphibianIsotopicNiches</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="#2: Compute niche metrics">
<meta property="og:description" content="AmphibianIsotopicNiches">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">AmphibianIsotopicNiches</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/010_Isotope_data_standardization.html">#1: Isotope data standardization</a>
    </li>
    <li>
      <a href="../articles/029_Install_siar_from_archive.html">Install siar from archive</a>
    </li>
    <li>
      <a href="../articles/030_Isotope_metrics.html">#2: Compute niche metrics</a>
    </li>
    <li>
      <a href="../articles/040_Trophic_networks_plots_ellipses.html">#3: Plots stable isotope niches with ellipses</a>
    </li>
    <li>
      <a href="../articles/060_Statistical_models_isotopes.html">#4: Compute statistical models</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>#2: Compute niche metrics</h1>
                        <h4 data-toc-skip class="author">Nadege
Belouard<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>
</h4>
            
            <h4 data-toc-skip class="date">03/06/2024</h4>
      
      
      <div class="hidden name"><code>030_Isotope_metrics.Rmd</code></div>

    </div>

    
    
<p>This vignette computes all the population stable isotope niche
metrics. We first load the packages.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">SIBER</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://here.r-lib.org/" class="external-link">here</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org" class="external-link">magrittr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tibble.tidyverse.org/" class="external-link">tibble</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://yihui.org/knitr/" class="external-link">knitr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/hadley/reshape" class="external-link">reshape2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://spatstat.org/" class="external-link">spatstat.utils</a></span><span class="op">)</span></span></code></pre></div>
<p>We then load the dataset and keep only the variables that will be
useful.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Dataset</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"exported_data"</span>, </span>
<span>                                       <span class="st">"Isotope_data_standardized.csv"</span><span class="op">)</span>, </span>
<span>                    header<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Dataset</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/compound.html" class="external-link">%&lt;&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">Pond</span>, <span class="va">Taxa</span>, <span class="va">Species</span>, <span class="va">Group</span>, <span class="va">Sample_ID</span>, </span>
<span>                    <span class="va">Weight</span>, <span class="va">TP</span>, <span class="va">D13Ccor_consoI</span><span class="op">)</span></span>
<span>  </span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">Dataset</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   Pond         Taxa      Species      Group Sample_ID Weight       TP</span></span>
<span><span class="co">## 1  P01 Palmate newt Palmate newt Amphibians  17TPAL19 0.4188 3.277441</span></span>
<span><span class="co">## 2  P01 Marbled newt Marbled newt Amphibians  17TMAR18 0.3951 2.797176</span></span>
<span><span class="co">## 3  P01 Marbled newt Marbled newt Amphibians   17TMAR4 0.4399 3.019971</span></span>
<span><span class="co">## 4  P01 Palmate newt Palmate newt Amphibians  17TPAL14 0.3875 2.918824</span></span>
<span><span class="co">## 5  P01 Palmate newt Palmate newt Amphibians   17TPAL3 0.4164 3.154412</span></span>
<span><span class="co">## 6  P01 Palmate newt Palmate newt Amphibians   17TPAL9 0.3931 2.879559</span></span>
<span><span class="co">##   D13Ccor_consoI</span></span>
<span><span class="co">## 1      0.8523813</span></span>
<span><span class="co">## 2      1.1461121</span></span>
<span><span class="co">## 3      1.0936514</span></span>
<span><span class="co">## 4      0.8300212</span></span>
<span><span class="co">## 5      1.0877660</span></span>
<span><span class="co">## 6      1.0428821</span></span></code></pre>
<div class="section level2">
<h2 id="crayfish-ontogenetic-shift">1- Crayfish ontogenetic shift<a class="anchor" aria-label="anchor" href="#crayfish-ontogenetic-shift"></a>
</h2>
<p>First we are looking into whether there is an ontogenetic shift in
crayfish. Wee load the crayfish length data</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">CrayfishLength</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"data_raw"</span>, </span>
<span>                                       <span class="st">"CrayfishLength.txt"</span><span class="op">)</span>, </span>
<span>                    header<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># keep only the stable isotope data for crayfish</span></span>
<span><span class="va">Crayfish</span> <span class="op">&lt;-</span> <span class="va">Dataset</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Species</span> <span class="op">==</span> <span class="st">"Crayfish"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># join the two datasets to obtain the length and stable isotope values for each individual</span></span>
<span><span class="va">Crayfish</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/compound.html" class="external-link">%&lt;&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">CrayfishLength</span>, by <span class="op">=</span> <span class="st">"Sample_ID"</span><span class="op">)</span></span>
<span><span class="co"># check that all individuals have been associated with a length</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">Crayfish</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">Length</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">==</span> <span class="fl">0</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] TRUE</span></span></code></pre>
<p>Plot the data to see if there is an ontogenetic shift</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Isotopic biplot</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">Crayfish</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">TP</span>, y <span class="op">=</span> <span class="va">D13Ccor_consoI</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col <span class="op">=</span> <span class="va">Taxa</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">Pond</span><span class="op">)</span></span></code></pre></div>
<p><img src="030_Isotope_metrics_files/figure-html/graph%20shift-1.png" width="700"></p>
<p>Test the ontogenetic shift on the carbon values first</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot the D13C data against the crayfish length</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">Crayfish</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">D13Ccor_consoI</span>, x <span class="op">=</span> <span class="va">Length</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="op">)</span>, show.legend <span class="op">=</span> <span class="cn">F</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="va">lm</span>, se <span class="op">=</span> <span class="cn">FALSE</span>, col <span class="op">=</span> <span class="st">"darkgray"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">Pond</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Crayfish length (mm)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/bquote.html" class="external-link">bquote</a></span><span class="op">(</span><span class="st">''</span><span class="op">*</span><span class="va">delta</span><span class="op">^</span><span class="fl">13</span><span class="op">~</span><span class="va">C</span><span class="op">[</span><span class="st">"cor"</span><span class="op">]</span><span class="op">*</span><span class="st">''</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## `geom_smooth()` using formula = 'y ~ x'</span></span></code></pre>
<p><img src="030_Isotope_metrics_files/figure-html/test%20shift%20on%20carbon%20values-1.png" width="700"></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># There is an ncrease in D13Ccor with length, except in P06, P10, P14, P16</span></span>
<span></span>
<span><span class="co"># Run the linear models for each pond</span></span>
<span><span class="va">Onto13C</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">D13Ccor_consoI</span> <span class="op">~</span> <span class="va">Length</span>, data <span class="op">=</span> <span class="va">Crayfish</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Pond</span> <span class="op">==</span> <span class="st">"P05"</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">Onto13C</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## lm(formula = D13Ccor_consoI ~ Length, data = Crayfish %&gt;% filter(Pond == </span></span>
<span><span class="co">##     "P05"))</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residuals:</span></span>
<span><span class="co">##       Min        1Q    Median        3Q       Max </span></span>
<span><span class="co">## -0.277989 -0.087142  0.001835  0.099274  0.253000 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##              Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">## (Intercept) -0.944143   0.076309 -12.373 4.29e-13 ***</span></span>
<span><span class="co">## Length       0.006091   0.001018   5.981 1.68e-06 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residual standard error: 0.1438 on 29 degrees of freedom</span></span>
<span><span class="co">## Multiple R-squared:  0.5523, Adjusted R-squared:  0.5369 </span></span>
<span><span class="co">## F-statistic: 35.78 on 1 and 29 DF,  p-value: 1.676e-06</span></span></code></pre>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># P05 D13Ccor_consoI = -0.944143 + 0.006091 * length, p = 1.68e-06 ***</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html" class="external-link">shapiro.test</a></span><span class="op">(</span><span class="va">Onto13C</span><span class="op">$</span><span class="va">residuals</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  Shapiro-Wilk normality test</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  Onto13C$residuals</span></span>
<span><span class="co">## W = 0.97531, p-value = 0.6741</span></span></code></pre>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Onto13C</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">D13Ccor_consoI</span> <span class="op">~</span> <span class="va">Length</span>, data <span class="op">=</span> <span class="va">Crayfish</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Pond</span> <span class="op">==</span> <span class="st">"P07"</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">Onto13C</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## lm(formula = D13Ccor_consoI ~ Length, data = Crayfish %&gt;% filter(Pond == </span></span>
<span><span class="co">##     "P07"))</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residuals:</span></span>
<span><span class="co">##       Min        1Q    Median        3Q       Max </span></span>
<span><span class="co">## -0.136118 -0.044853 -0.000962  0.048783  0.098944 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##               Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">## (Intercept) -0.4014810  0.0379103  -10.59 6.34e-11 ***</span></span>
<span><span class="co">## Length       0.0051519  0.0004399   11.71 7.19e-12 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residual standard error: 0.06009 on 26 degrees of freedom</span></span>
<span><span class="co">## Multiple R-squared:  0.8406, Adjusted R-squared:  0.8345 </span></span>
<span><span class="co">## F-statistic: 137.1 on 1 and 26 DF,  p-value: 7.187e-12</span></span></code></pre>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># P07 y = -0.4014810 + 0.0051519 x, p = 7.19e-12 ***</span></span>
<span></span>
<span><span class="va">Onto13C</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">D13Ccor_consoI</span> <span class="op">~</span> <span class="va">Length</span>, data <span class="op">=</span> <span class="va">Crayfish</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Pond</span> <span class="op">==</span> <span class="st">"P08"</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">Onto13C</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## lm(formula = D13Ccor_consoI ~ Length, data = Crayfish %&gt;% filter(Pond == </span></span>
<span><span class="co">##     "P08"))</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residuals:</span></span>
<span><span class="co">##      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">## -0.22928 -0.06243  0.01034  0.06890  0.14582 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##               Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">## (Intercept) -0.1880660  0.0373533  -5.035 1.55e-05 ***</span></span>
<span><span class="co">## Length       0.0066872  0.0006019  11.110 7.36e-13 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residual standard error: 0.103 on 34 degrees of freedom</span></span>
<span><span class="co">## Multiple R-squared:  0.784,  Adjusted R-squared:  0.7777 </span></span>
<span><span class="co">## F-statistic: 123.4 on 1 and 34 DF,  p-value: 7.36e-13</span></span></code></pre>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># P08 y = -0.1880660 + 0.006687 x, p = 7.36e-13 ***</span></span>
<span></span>
<span><span class="va">Onto13C</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">D13Ccor_consoI</span> <span class="op">~</span> <span class="va">Length</span>, data <span class="op">=</span> <span class="va">Crayfish</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Pond</span> <span class="op">==</span> <span class="st">"P09"</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">Onto13C</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## lm(formula = D13Ccor_consoI ~ Length, data = Crayfish %&gt;% filter(Pond == </span></span>
<span><span class="co">##     "P09"))</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residuals:</span></span>
<span><span class="co">##      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">## -0.05424 -0.01239 -0.00208  0.02282  0.05250 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##               Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">## (Intercept) -0.2867501  0.0220411  -13.01 4.33e-12 ***</span></span>
<span><span class="co">## Length       0.0047571  0.0002432   19.56 7.82e-16 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residual standard error: 0.02887 on 23 degrees of freedom</span></span>
<span><span class="co">## Multiple R-squared:  0.9433, Adjusted R-squared:  0.9408 </span></span>
<span><span class="co">## F-statistic: 382.7 on 1 and 23 DF,  p-value: 7.816e-16</span></span></code></pre>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># P09 y = -0.2867501 + 0.0047571 x, p = 7.82e-16 ***</span></span>
<span></span>
<span><span class="va">Onto13C</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">D13Ccor_consoI</span> <span class="op">~</span> <span class="va">Length</span>, data <span class="op">=</span> <span class="va">Crayfish</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Pond</span> <span class="op">==</span> <span class="st">"P10"</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">Onto13C</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## lm(formula = D13Ccor_consoI ~ Length, data = Crayfish %&gt;% filter(Pond == </span></span>
<span><span class="co">##     "P10"))</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residuals:</span></span>
<span><span class="co">##      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">## -0.38732 -0.13892  0.00274  0.13722  0.27769 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##              Estimate Std. Error t value Pr(&gt;|t|)   </span></span>
<span><span class="co">## (Intercept)  0.127039   0.092739   1.370  0.18162   </span></span>
<span><span class="co">## Length      -0.003261   0.001155  -2.824  0.00865 **</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residual standard error: 0.1725 on 28 degrees of freedom</span></span>
<span><span class="co">## Multiple R-squared:  0.2216, Adjusted R-squared:  0.1938 </span></span>
<span><span class="co">## F-statistic: 7.973 on 1 and 28 DF,  p-value: 0.008646</span></span></code></pre>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># P10 y = 0.127039 - 0.003261 x, p = 0.00865 ** NEGATIVE ESTIMATE</span></span>
<span></span>
<span><span class="va">Onto13C</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">D13Ccor_consoI</span> <span class="op">~</span> <span class="va">Length</span>, data <span class="op">=</span> <span class="va">Crayfish</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Pond</span> <span class="op">==</span> <span class="st">"P13"</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">Onto13C</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## lm(formula = D13Ccor_consoI ~ Length, data = Crayfish %&gt;% filter(Pond == </span></span>
<span><span class="co">##     "P13"))</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residuals:</span></span>
<span><span class="co">##      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">## -0.16997 -0.04098  0.01412  0.03434  0.09597 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##               Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">## (Intercept) -0.1429704  0.0400999  -3.565  0.00133 ** </span></span>
<span><span class="co">## Length       0.0041330  0.0005158   8.012    1e-08 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residual standard error: 0.0608 on 28 degrees of freedom</span></span>
<span><span class="co">## Multiple R-squared:  0.6963, Adjusted R-squared:  0.6855 </span></span>
<span><span class="co">## F-statistic:  64.2 on 1 and 28 DF,  p-value: 1.003e-08</span></span></code></pre>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># P13 y = -0.1429704 + 0.0041330 x, p = 1e-08 ***</span></span>
<span></span>
<span><span class="va">Onto13C</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">D13Ccor_consoI</span> <span class="op">~</span> <span class="va">Length</span>, data <span class="op">=</span> <span class="va">Crayfish</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Pond</span> <span class="op">==</span> <span class="st">"P14"</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">Onto13C</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## lm(formula = D13Ccor_consoI ~ Length, data = Crayfish %&gt;% filter(Pond == </span></span>
<span><span class="co">##     "P14"))</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residuals:</span></span>
<span><span class="co">##      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">## -0.17654 -0.07365 -0.02159  0.07622  0.34923 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##               Estimate Std. Error t value Pr(&gt;|t|)</span></span>
<span><span class="co">## (Intercept)  0.0562290  0.0563632   0.998    0.325</span></span>
<span><span class="co">## Length      -0.0012756  0.0008278  -1.541    0.132</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residual standard error: 0.1127 on 38 degrees of freedom</span></span>
<span><span class="co">## Multiple R-squared:  0.05881,    Adjusted R-squared:  0.03404 </span></span>
<span><span class="co">## F-statistic: 2.375 on 1 and 38 DF,  p-value: 0.1316</span></span></code></pre>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># P14 y = 0.0562290 -0.0012756 x, p = 0.132 NS and NEGATIVE ESTIMATE</span></span>
<span></span>
<span><span class="va">Onto13C</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">D13Ccor_consoI</span> <span class="op">~</span> <span class="va">Length</span>, data <span class="op">=</span> <span class="va">Crayfish</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Pond</span> <span class="op">==</span> <span class="st">"P15"</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">Onto13C</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## lm(formula = D13Ccor_consoI ~ Length, data = Crayfish %&gt;% filter(Pond == </span></span>
<span><span class="co">##     "P15"))</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residuals:</span></span>
<span><span class="co">##       Min        1Q    Median        3Q       Max </span></span>
<span><span class="co">## -0.129910 -0.042671  0.003507  0.055913  0.126981 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##              Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">## (Intercept) 0.0181422  0.0356582   0.509    0.614    </span></span>
<span><span class="co">## Length      0.0021203  0.0004636   4.573 5.78e-05 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residual standard error: 0.07143 on 35 degrees of freedom</span></span>
<span><span class="co">## Multiple R-squared:  0.3741, Adjusted R-squared:  0.3562 </span></span>
<span><span class="co">## F-statistic: 20.92 on 1 and 35 DF,  p-value: 5.778e-05</span></span></code></pre>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># P15 y = 0.0181422 + 0.0021203 x, p = 5.78e-05 ***</span></span>
<span></span>
<span><span class="va">Onto13C</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">D13Ccor_consoI</span> <span class="op">~</span> <span class="va">Length</span>, data <span class="op">=</span> <span class="va">Crayfish</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Pond</span> <span class="op">==</span> <span class="st">"P16"</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">Onto13C</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## lm(formula = D13Ccor_consoI ~ Length, data = Crayfish %&gt;% filter(Pond == </span></span>
<span><span class="co">##     "P16"))</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residuals:</span></span>
<span><span class="co">##      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">## -0.08961 -0.05660 -0.02054  0.06072  0.11879 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##              Estimate Std. Error t value Pr(&gt;|t|)  </span></span>
<span><span class="co">## (Intercept)  0.257888   0.105471   2.445   0.0239 *</span></span>
<span><span class="co">## Length      -0.002912   0.001190  -2.448   0.0237 *</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residual standard error: 0.0681 on 20 degrees of freedom</span></span>
<span><span class="co">## Multiple R-squared:  0.2306, Adjusted R-squared:  0.1921 </span></span>
<span><span class="co">## F-statistic: 5.994 on 1 and 20 DF,  p-value: 0.0237</span></span></code></pre>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># P16 y = 0.257888 - 0.002912 x, p = 0.0237 * NEGATIVE ESTIMATE</span></span>
<span></span>
<span><span class="va">Onto13C</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">D13Ccor_consoI</span> <span class="op">~</span> <span class="va">Length</span>, data <span class="op">=</span> <span class="va">Crayfish</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Pond</span> <span class="op">==</span> <span class="st">"P17"</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">Onto13C</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## lm(formula = D13Ccor_consoI ~ Length, data = Crayfish %&gt;% filter(Pond == </span></span>
<span><span class="co">##     "P17"))</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residuals:</span></span>
<span><span class="co">##      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">## -0.15031 -0.09097  0.00594  0.05908  0.24247 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##               Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">## (Intercept) -0.7509301  0.0706267  -10.63 1.46e-10 ***</span></span>
<span><span class="co">## Length       0.0101905  0.0008453   12.06 1.14e-11 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residual standard error: 0.1056 on 24 degrees of freedom</span></span>
<span><span class="co">## Multiple R-squared:  0.8583, Adjusted R-squared:  0.8524 </span></span>
<span><span class="co">## F-statistic: 145.3 on 1 and 24 DF,  p-value: 1.135e-11</span></span></code></pre>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># P17 y = -0.7509301 + 0.0101905 x, p = 1.14e-11 ***</span></span>
<span></span>
<span><span class="va">Onto13C</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">D13Ccor_consoI</span> <span class="op">~</span> <span class="va">Length</span>, data <span class="op">=</span> <span class="va">Crayfish</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Pond</span> <span class="op">==</span> <span class="st">"P18"</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">Onto13C</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## lm(formula = D13Ccor_consoI ~ Length, data = Crayfish %&gt;% filter(Pond == </span></span>
<span><span class="co">##     "P18"))</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residuals:</span></span>
<span><span class="co">##      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">## -0.27299 -0.13143 -0.00979  0.09390  0.48322 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##              Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">## (Intercept) -0.238652   0.063057  -3.785 0.000494 ***</span></span>
<span><span class="co">## Length       0.006569   0.001006   6.529 7.66e-08 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residual standard error: 0.1728 on 41 degrees of freedom</span></span>
<span><span class="co">## Multiple R-squared:  0.5097, Adjusted R-squared:  0.4977 </span></span>
<span><span class="co">## F-statistic: 42.62 on 1 and 41 DF,  p-value: 7.662e-08</span></span></code></pre>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># P18 y = -0.238652 + 0.006569 x, p = 7.66e-08 ***</span></span></code></pre></div>
<p>Now test for nitrogen values</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Plot the ontogenetic shift on nitrogen values against crayfish length</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">Crayfish</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Length</span>, y <span class="op">=</span> <span class="va">TP</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="op">)</span>, show.legend <span class="op">=</span> <span class="cn">F</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="va">lm</span>, se <span class="op">=</span> <span class="cn">FALSE</span>, col <span class="op">=</span> <span class="st">"darkgray"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">Pond</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Crayfish length (mm)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># ylab("TP") +</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## `geom_smooth()` using formula = 'y ~ x'</span></span></code></pre>
<p><img src="030_Isotope_metrics_files/figure-html/test%20shift%20on%20nitrogen%20values-1.png" width="700"></p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Run the linear model for each pond</span></span>
<span><span class="va">OntoTP</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">TP</span> <span class="op">~</span> <span class="va">Length</span>, data <span class="op">=</span> <span class="va">Crayfish</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Pond</span> <span class="op">==</span> <span class="st">"P05"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">OntoTP</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## lm(formula = TP ~ Length, data = Crayfish %&gt;% filter(Pond == </span></span>
<span><span class="co">##     "P05"))</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residuals:</span></span>
<span><span class="co">##      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">## -0.19039 -0.07593 -0.00650  0.04963  0.22453 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##               Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">## (Intercept)  2.6661974  0.0563674  47.300  &lt; 2e-16 ***</span></span>
<span><span class="co">## Length      -0.0035418  0.0007522  -4.709  5.7e-05 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residual standard error: 0.1062 on 29 degrees of freedom</span></span>
<span><span class="co">## Multiple R-squared:  0.4333, Adjusted R-squared:  0.4137 </span></span>
<span><span class="co">## F-statistic: 22.17 on 1 and 29 DF,  p-value: 5.696e-05</span></span></code></pre>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html" class="external-link">shapiro.test</a></span><span class="op">(</span><span class="va">OntoTP</span><span class="op">$</span><span class="va">residuals</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  Shapiro-Wilk normality test</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  OntoTP$residuals</span></span>
<span><span class="co">## W = 0.97928, p-value = 0.7923</span></span></code></pre>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># P05 y = 2.6661974 -0.0035418 x, p = 5.7e-05 ***, NEGATIVE ESTIMATE</span></span>
<span></span>
<span><span class="va">OntoTP</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">TP</span> <span class="op">~</span> <span class="va">Length</span>, data <span class="op">=</span> <span class="va">Crayfish</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Pond</span> <span class="op">==</span> <span class="st">"P07"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">OntoTP</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## lm(formula = TP ~ Length, data = Crayfish %&gt;% filter(Pond == </span></span>
<span><span class="co">##     "P07"))</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residuals:</span></span>
<span><span class="co">##       Min        1Q    Median        3Q       Max </span></span>
<span><span class="co">## -0.167336 -0.059884 -0.004783  0.057123  0.203461 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##              Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">## (Intercept) 2.864e+00  5.137e-02   55.76   &lt;2e-16 ***</span></span>
<span><span class="co">## Length      2.975e-05  5.962e-04    0.05    0.961    </span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residual standard error: 0.08143 on 26 degrees of freedom</span></span>
<span><span class="co">## Multiple R-squared:  9.575e-05,  Adjusted R-squared:  -0.03836 </span></span>
<span><span class="co">## F-statistic: 0.00249 on 1 and 26 DF,  p-value: 0.9606</span></span></code></pre>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># P07 y = 2.864e+00 + 2.975e-05 x, p = 0.961, NS</span></span>
<span></span>
<span><span class="va">OntoTP</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">TP</span> <span class="op">~</span> <span class="va">Length</span>, data <span class="op">=</span> <span class="va">Crayfish</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Pond</span> <span class="op">==</span> <span class="st">"P08"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">OntoTP</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## lm(formula = TP ~ Length, data = Crayfish %&gt;% filter(Pond == </span></span>
<span><span class="co">##     "P08"))</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residuals:</span></span>
<span><span class="co">##      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">## -0.37478 -0.08082  0.01091  0.07917  0.55844 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">## (Intercept) 2.350218   0.066370   35.41  &lt; 2e-16 ***</span></span>
<span><span class="co">## Length      0.011484   0.001069   10.74 1.83e-12 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residual standard error: 0.1831 on 34 degrees of freedom</span></span>
<span><span class="co">## Multiple R-squared:  0.7723, Adjusted R-squared:  0.7656 </span></span>
<span><span class="co">## F-statistic: 115.3 on 1 and 34 DF,  p-value: 1.827e-12</span></span></code></pre>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># P08 y = 2.350218 + 0.011484 x, p = 1.83e-12 ***, </span></span>
<span></span>
<span><span class="va">OntoTP</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">TP</span> <span class="op">~</span> <span class="va">Length</span>, data <span class="op">=</span> <span class="va">Crayfish</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Pond</span> <span class="op">==</span> <span class="st">"P09"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">OntoTP</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## lm(formula = TP ~ Length, data = Crayfish %&gt;% filter(Pond == </span></span>
<span><span class="co">##     "P09"))</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residuals:</span></span>
<span><span class="co">##       Min        1Q    Median        3Q       Max </span></span>
<span><span class="co">## -0.172969 -0.044155  0.004554  0.062357  0.095296 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##              Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">## (Intercept) 2.2342960  0.0545231  40.979  &lt; 2e-16 ***</span></span>
<span><span class="co">## Length      0.0046668  0.0006015   7.759 7.23e-08 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residual standard error: 0.07141 on 23 degrees of freedom</span></span>
<span><span class="co">## Multiple R-squared:  0.7235, Adjusted R-squared:  0.7115 </span></span>
<span><span class="co">## F-statistic:  60.2 on 1 and 23 DF,  p-value: 7.227e-08</span></span></code></pre>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># P09 y = 2.2342960+ 0.0046668x, p =7.23e-08 ***, </span></span>
<span></span>
<span><span class="va">OntoTP</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">TP</span> <span class="op">~</span> <span class="va">Length</span>, data <span class="op">=</span> <span class="va">Crayfish</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Pond</span> <span class="op">==</span> <span class="st">"P10"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">OntoTP</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## lm(formula = TP ~ Length, data = Crayfish %&gt;% filter(Pond == </span></span>
<span><span class="co">##     "P10"))</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residuals:</span></span>
<span><span class="co">##      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">## -0.14641 -0.04596  0.01178  0.05776  0.16605 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##              Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">## (Intercept) 2.5093372  0.0440535  56.961  &lt; 2e-16 ***</span></span>
<span><span class="co">## Length      0.0039351  0.0005486   7.173 8.31e-08 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residual standard error: 0.08193 on 28 degrees of freedom</span></span>
<span><span class="co">## Multiple R-squared:  0.6476, Adjusted R-squared:  0.635 </span></span>
<span><span class="co">## F-statistic: 51.46 on 1 and 28 DF,  p-value: 8.313e-08</span></span></code></pre>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># P10 y = 2.5093372+ 0.0039351x, p =8.31e-08 ***, </span></span>
<span></span>
<span><span class="va">OntoTP</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">TP</span> <span class="op">~</span> <span class="va">Length</span>, data <span class="op">=</span> <span class="va">Crayfish</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Pond</span> <span class="op">==</span> <span class="st">"P13"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">OntoTP</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## lm(formula = TP ~ Length, data = Crayfish %&gt;% filter(Pond == </span></span>
<span><span class="co">##     "P13"))</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residuals:</span></span>
<span><span class="co">##      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">## -0.26201 -0.09588 -0.02692  0.09986  0.29700 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##              Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">## (Intercept)  2.346057   0.101950  23.012  &lt; 2e-16 ***</span></span>
<span><span class="co">## Length      -0.005903   0.001311  -4.501 0.000108 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residual standard error: 0.1546 on 28 degrees of freedom</span></span>
<span><span class="co">## Multiple R-squared:  0.4198, Adjusted R-squared:  0.3991 </span></span>
<span><span class="co">## F-statistic: 20.26 on 1 and 28 DF,  p-value: 0.0001083</span></span></code></pre>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># P13 y = 2.346057-0.005903 x, p =0.000108 ***,  NEGATIVE ESTIMATE</span></span>
<span></span>
<span><span class="va">OntoTP</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">TP</span> <span class="op">~</span> <span class="va">Length</span>, data <span class="op">=</span> <span class="va">Crayfish</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Pond</span> <span class="op">==</span> <span class="st">"P14"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">OntoTP</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## lm(formula = TP ~ Length, data = Crayfish %&gt;% filter(Pond == </span></span>
<span><span class="co">##     "P14"))</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residuals:</span></span>
<span><span class="co">##       Min        1Q    Median        3Q       Max </span></span>
<span><span class="co">## -0.229396 -0.072339 -0.006471  0.070140  0.196171 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##              Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">## (Intercept) 2.4414659  0.0523221  46.662   &lt;2e-16 ***</span></span>
<span><span class="co">## Length      0.0019453  0.0007684   2.532   0.0156 *  </span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residual standard error: 0.1046 on 38 degrees of freedom</span></span>
<span><span class="co">## Multiple R-squared:  0.1443, Adjusted R-squared:  0.1218 </span></span>
<span><span class="co">## F-statistic: 6.409 on 1 and 38 DF,  p-value: 0.01561</span></span></code></pre>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># P14 y = 2.4414659+ 0.0019453x, p =0.0156 *</span></span>
<span></span>
<span><span class="va">OntoTP</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">TP</span> <span class="op">~</span> <span class="va">Length</span>, data <span class="op">=</span> <span class="va">Crayfish</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Pond</span> <span class="op">==</span> <span class="st">"P15"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">OntoTP</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## lm(formula = TP ~ Length, data = Crayfish %&gt;% filter(Pond == </span></span>
<span><span class="co">##     "P15"))</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residuals:</span></span>
<span><span class="co">##      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">## -0.13282 -0.06521 -0.01200  0.04067  0.33092 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##              Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">## (Intercept) 2.3161938  0.0457689  50.606   &lt;2e-16 ***</span></span>
<span><span class="co">## Length      0.0009667  0.0005951   1.625    0.113    </span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residual standard error: 0.09168 on 35 degrees of freedom</span></span>
<span><span class="co">## Multiple R-squared:  0.07012,    Adjusted R-squared:  0.04355 </span></span>
<span><span class="co">## F-statistic: 2.639 on 1 and 35 DF,  p-value: 0.1132</span></span></code></pre>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># P15 y = 2.3161938+ 0.0009667x, p =0.113, NS</span></span>
<span></span>
<span><span class="va">OntoTP</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">TP</span> <span class="op">~</span> <span class="va">Length</span>, data <span class="op">=</span> <span class="va">Crayfish</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Pond</span> <span class="op">==</span> <span class="st">"P16"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">OntoTP</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## lm(formula = TP ~ Length, data = Crayfish %&gt;% filter(Pond == </span></span>
<span><span class="co">##     "P16"))</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residuals:</span></span>
<span><span class="co">##       Min        1Q    Median        3Q       Max </span></span>
<span><span class="co">## -0.169874 -0.042028 -0.006689  0.033300  0.155364 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">## (Intercept) 2.510389   0.135481  18.529 4.62e-14 ***</span></span>
<span><span class="co">## Length      0.002087   0.001528   1.366    0.187    </span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residual standard error: 0.08748 on 20 degrees of freedom</span></span>
<span><span class="co">## Multiple R-squared:  0.08528,    Adjusted R-squared:  0.03954 </span></span>
<span><span class="co">## F-statistic: 1.865 on 1 and 20 DF,  p-value: 0.1873</span></span></code></pre>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># P16 y = 2.510389+ 0.002087x, p =0.187, NS</span></span>
<span></span>
<span><span class="va">OntoTP</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">TP</span> <span class="op">~</span> <span class="va">Length</span>, data <span class="op">=</span> <span class="va">Crayfish</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Pond</span> <span class="op">==</span> <span class="st">"P17"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">OntoTP</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## lm(formula = TP ~ Length, data = Crayfish %&gt;% filter(Pond == </span></span>
<span><span class="co">##     "P17"))</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residuals:</span></span>
<span><span class="co">##      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">## -0.19918 -0.08782 -0.01597  0.01972  0.83366 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">## (Intercept) 2.196241   0.125751  17.465 3.79e-15 ***</span></span>
<span><span class="co">## Length      0.002532   0.001505   1.682    0.105    </span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residual standard error: 0.188 on 24 degrees of freedom</span></span>
<span><span class="co">## Multiple R-squared:  0.1055, Adjusted R-squared:  0.06821 </span></span>
<span><span class="co">## F-statistic:  2.83 on 1 and 24 DF,  p-value: 0.1055</span></span></code></pre>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># P17 y = 2.196241+ 0.002532x, p =0.105, NS</span></span>
<span></span>
<span><span class="va">OntoTP</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">TP</span> <span class="op">~</span> <span class="va">Length</span>, data <span class="op">=</span> <span class="va">Crayfish</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Pond</span> <span class="op">==</span> <span class="st">"P18"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">OntoTP</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## lm(formula = TP ~ Length, data = Crayfish %&gt;% filter(Pond == </span></span>
<span><span class="co">##     "P18"))</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residuals:</span></span>
<span><span class="co">##      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">## -0.33678 -0.12708 -0.00024  0.11567  0.34448 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##              Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">## (Intercept) 1.8632440  0.0600664  31.020  &lt; 2e-16 ***</span></span>
<span><span class="co">## Length      0.0039885  0.0009585   4.161 0.000158 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residual standard error: 0.1646 on 41 degrees of freedom</span></span>
<span><span class="co">## Multiple R-squared:  0.2969, Adjusted R-squared:  0.2798 </span></span>
<span><span class="co">## F-statistic: 17.32 on 1 and 41 DF,  p-value: 0.000158</span></span></code></pre>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># P18 y = 1.8632440+ 0.0039885x, p =0.000158 ***</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="population-metrics">2- Population metrics<a class="anchor" aria-label="anchor" href="#population-metrics"></a>
</h2>
<p>We calculate population metrics for amphibians and crayfish.</p>
<p>We begin with selecting the species of interest and removing
populations with inadequate samples sizes, i.e.Â large populations with n
&lt; 10. Some populations have n &lt; 10 but are kept because we have
good indicators from CMR that the sample size is representative of the
population.</p>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># We want to exclude target populations with n &lt; 10, except three pops: marbled newt in ponds P04 and P11, and palmate newt in pop P10 where we assume we have sampled the entire population.</span></span>
<span><span class="va">Dataset</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">Species</span>, <span class="va">Pond</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">n</span> <span class="op">&lt;</span> <span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 13 Ã— 3</span></span></span>
<span><span class="co">## <span style="color: #949494;"># Groups:   Species [4]</span></span></span>
<span><span class="co">##    Species      Pond      n</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> Agile frog   P02       9</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> Agile frog   P17       8</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> Crayfish     P06       4</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> Marbled newt P04       7</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> Marbled newt P08       2</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> Marbled newt P10       6</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> Marbled newt P11       9</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> Palmate newt P07       1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> Palmate newt P10       9</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> Palmate newt P13       1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">11</span> Palmate newt P14       1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">12</span> Palmate newt P16       1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">13</span> Palmate newt P17       5</span></span></code></pre>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Dataset</span><span class="op">&lt;-</span><span class="va">Dataset</span><span class="op">[</span><span class="op">!</span><span class="va">Dataset</span><span class="op">$</span><span class="va">Species</span><span class="op">==</span><span class="st">"Crayfish"</span><span class="op">|</span></span>
<span>                                 <span class="op">!</span><span class="va">Dataset</span><span class="op">$</span><span class="va">Pond</span> <span class="op">==</span> <span class="st">"P06"</span>,<span class="op">]</span></span>
<span><span class="va">Dataset</span><span class="op">&lt;-</span><span class="va">Dataset</span><span class="op">[</span><span class="op">!</span><span class="va">Dataset</span><span class="op">$</span><span class="va">Species</span><span class="op">==</span><span class="st">"Agile frog"</span><span class="op">|</span></span>
<span>                                 <span class="op">!</span><span class="va">Dataset</span><span class="op">$</span><span class="va">Pond</span><span class="op">==</span><span class="st">"P02"</span>,<span class="op">]</span></span>
<span><span class="va">Dataset</span><span class="op">&lt;-</span><span class="va">Dataset</span><span class="op">[</span><span class="op">!</span><span class="va">Dataset</span><span class="op">$</span><span class="va">Species</span><span class="op">==</span><span class="st">"Agile frog"</span><span class="op">|</span></span>
<span>                                 <span class="op">!</span><span class="va">Dataset</span><span class="op">$</span><span class="va">Pond</span><span class="op">==</span><span class="st">"P17"</span>,<span class="op">]</span></span>
<span><span class="va">Dataset</span><span class="op">&lt;-</span><span class="va">Dataset</span><span class="op">[</span><span class="op">!</span><span class="va">Dataset</span><span class="op">$</span><span class="va">Species</span><span class="op">==</span><span class="st">"Marbled newt"</span><span class="op">|</span></span>
<span>                                 <span class="op">!</span><span class="va">Dataset</span><span class="op">$</span><span class="va">Pond</span><span class="op">==</span><span class="st">"P08"</span>,<span class="op">]</span></span>
<span><span class="va">Dataset</span><span class="op">&lt;-</span><span class="va">Dataset</span><span class="op">[</span><span class="op">!</span><span class="va">Dataset</span><span class="op">$</span><span class="va">Species</span><span class="op">==</span><span class="st">"Marbled newt"</span><span class="op">|</span></span>
<span>                                 <span class="op">!</span><span class="va">Dataset</span><span class="op">$</span><span class="va">Pond</span><span class="op">==</span><span class="st">"P10"</span>,<span class="op">]</span></span>
<span><span class="va">Dataset</span><span class="op">&lt;-</span><span class="va">Dataset</span><span class="op">[</span><span class="op">!</span><span class="va">Dataset</span><span class="op">$</span><span class="va">Species</span><span class="op">==</span><span class="st">"Palmate newt"</span><span class="op">|</span></span>
<span>                                 <span class="op">!</span><span class="va">Dataset</span><span class="op">$</span><span class="va">Pond</span><span class="op">==</span><span class="st">"P07"</span>,<span class="op">]</span></span>
<span><span class="va">Dataset</span><span class="op">&lt;-</span><span class="va">Dataset</span><span class="op">[</span><span class="op">!</span><span class="va">Dataset</span><span class="op">$</span><span class="va">Species</span><span class="op">==</span><span class="st">"Palmate newt"</span><span class="op">|</span></span>
<span>                                 <span class="op">!</span><span class="va">Dataset</span><span class="op">$</span><span class="va">Pond</span><span class="op">==</span> <span class="st">"P13"</span>,<span class="op">]</span></span>
<span><span class="va">Dataset</span><span class="op">&lt;-</span><span class="va">Dataset</span><span class="op">[</span><span class="op">!</span><span class="va">Dataset</span><span class="op">$</span><span class="va">Species</span><span class="op">==</span><span class="st">"Palmate newt"</span><span class="op">|</span></span>
<span>                                 <span class="op">!</span><span class="va">Dataset</span><span class="op">$</span><span class="va">Pond</span><span class="op">==</span> <span class="st">"P14"</span>,<span class="op">]</span></span>
<span><span class="va">Dataset</span><span class="op">&lt;-</span><span class="va">Dataset</span><span class="op">[</span><span class="op">!</span><span class="va">Dataset</span><span class="op">$</span><span class="va">Species</span><span class="op">==</span><span class="st">"Palmate newt"</span><span class="op">|</span></span>
<span>                                 <span class="op">!</span><span class="va">Dataset</span><span class="op">$</span><span class="va">Pond</span><span class="op">==</span><span class="st">"P16"</span>,<span class="op">]</span></span>
<span><span class="va">Dataset</span><span class="op">&lt;-</span><span class="va">Dataset</span><span class="op">[</span><span class="op">!</span><span class="va">Dataset</span><span class="op">$</span><span class="va">Species</span><span class="op">==</span><span class="st">"Palmate newt"</span><span class="op">|</span></span>
<span>                                 <span class="op">!</span><span class="va">Dataset</span><span class="op">$</span><span class="va">Pond</span><span class="op">==</span><span class="st">"P17"</span>,<span class="op">]</span></span>
<span></span>
<span></span>
<span><span class="co"># Separate per niche (species x pond)</span></span>
<span><span class="va">spx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/split.html" class="external-link">split</a></span><span class="op">(</span><span class="va">Dataset</span><span class="op">$</span><span class="va">D13Ccor_consoI</span>, </span>
<span>             <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">Dataset</span><span class="op">$</span><span class="va">Pond</span>, <span class="va">Dataset</span><span class="op">$</span><span class="va">Species</span><span class="op">)</span>, drop <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">spy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/split.html" class="external-link">split</a></span><span class="op">(</span><span class="va">Dataset</span><span class="op">$</span><span class="va">TP</span>, </span>
<span>             <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">Dataset</span><span class="op">$</span><span class="va">Pond</span>, <span class="va">Dataset</span><span class="op">$</span><span class="va">Species</span><span class="op">)</span>, drop <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span></span>
<span></span>
<span><span class="co"># # In the case where we consider separately adult and juvenile crayfish (for a figure in Supp. Mat), run the following lines too</span></span>
<span><span class="co"># Dataset %&gt;% filter(Species == "Crayfish") %&gt;% group_by(Taxa, Pond) %&gt;% summarise(n = n()) %&gt;% </span></span>
<span><span class="co">#   filter(n &lt; 10)</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># Dataset&lt;-Dataset[!Dataset$Taxa=="Juv crayfish"|</span></span>
<span><span class="co">#                                  !Dataset$Pond=="P09",]</span></span>
<span><span class="co"># Dataset&lt;-Dataset[!Dataset$Taxa=="Juv crayfish"|</span></span>
<span><span class="co">#                                  !Dataset$Pond=="P16",]</span></span>
<span><span class="co"># Dataset&lt;-Dataset[!Dataset$Taxa=="Juv crayfish"|</span></span>
<span><span class="co">#                                  !Dataset$Pond=="P17",]</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># spx &lt;- split(Dataset$D13Ccor_consoI, </span></span>
<span><span class="co">#              list(Dataset$Pond, Dataset$Taxa), drop = TRUE)</span></span>
<span><span class="co"># spy &lt;- split(Dataset$TP, </span></span>
<span><span class="co">#              list(Dataset$Pond, Dataset$Taxa), drop = TRUE)</span></span></code></pre></div>
<p>Check if the number of individuals is correct</p>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">Dataset</span><span class="op">[</span><span class="va">Dataset</span><span class="op">$</span><span class="va">Taxa</span><span class="op">==</span><span class="st">"Agile frog"</span>,<span class="op">]</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">==</span> <span class="fl">254</span> </span></code></pre></div>
<pre><code><span><span class="co">## [1] TRUE</span></span></code></pre>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">Dataset</span><span class="op">[</span><span class="va">Dataset</span><span class="op">$</span><span class="va">Taxa</span><span class="op">==</span><span class="st">"Tree frog"</span>,<span class="op">]</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">==</span> <span class="fl">168</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] TRUE</span></span></code></pre>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">Dataset</span><span class="op">[</span><span class="va">Dataset</span><span class="op">$</span><span class="va">Taxa</span><span class="op">==</span><span class="st">"Palmate newt"</span>,<span class="op">]</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">==</span> <span class="fl">192</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] TRUE</span></span></code></pre>
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">Dataset</span><span class="op">[</span><span class="va">Dataset</span><span class="op">$</span><span class="va">Taxa</span><span class="op">==</span><span class="st">"Marbled newt"</span>,<span class="op">]</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">==</span> <span class="fl">101</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] TRUE</span></span></code></pre>
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">Dataset</span><span class="op">[</span><span class="va">Dataset</span><span class="op">$</span><span class="va">Species</span><span class="op">==</span><span class="st">"Crayfish"</span>,<span class="op">]</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">==</span> <span class="fl">348</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] TRUE</span></span></code></pre>
<div class="section level3">
<h3 id="a--sea-coordinates">a- SEA coordinates<a class="anchor" aria-label="anchor" href="#a--sea-coordinates"></a>
</h3>
<p>We then generate the coordinates of the ellipses so we can plot them
later.</p>
<div class="sourceCode" id="cb74"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Pop</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="va">coordY</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="va">coordX</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="va">j</span> <span class="op">=</span> <span class="fl">1</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">spx</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">SE</span> <span class="op">&lt;-</span> <span class="fu">siar</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/siar/man/standard.ellipse.html" class="external-link">standard.ellipse</a></span><span class="op">(</span><span class="va">spx</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>,<span class="va">spy</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>,steps<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">Pop</span><span class="op">[</span><span class="va">j</span><span class="op">:</span><span class="op">(</span><span class="va">j</span><span class="op">+</span><span class="fl">360</span><span class="op">)</span><span class="op">]</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">spx</span><span class="op">)</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span>  <span class="va">coordY</span><span class="op">[</span><span class="va">j</span><span class="op">:</span><span class="op">(</span><span class="va">j</span><span class="op">+</span><span class="fl">360</span><span class="op">)</span><span class="op">]</span><span class="op">&lt;-</span><span class="va">SE</span><span class="op">$</span><span class="va">ySEAc</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">361</span><span class="op">]</span></span>
<span>  <span class="va">coordX</span><span class="op">[</span><span class="va">j</span><span class="op">:</span><span class="op">(</span><span class="va">j</span><span class="op">+</span><span class="fl">360</span><span class="op">)</span><span class="op">]</span><span class="op">&lt;-</span><span class="va">SE</span><span class="op">$</span><span class="va">xSEAc</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">361</span><span class="op">]</span></span>
<span>  <span class="va">j</span><span class="op">=</span><span class="va">j</span><span class="op">+</span><span class="fl">361</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">CoordSEAc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">Pop</span>,<span class="va">coordY</span>,<span class="va">coordX</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">CoordSEAc</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##      Pop               coordY             coordX         </span></span>
<span><span class="co">##  Length:18772       Length:18772       Length:18772      </span></span>
<span><span class="co">##  Class :character   Class :character   Class :character  </span></span>
<span><span class="co">##  Mode  :character   Mode  :character   Mode  :character</span></span></code></pre>
<div class="sourceCode" id="cb76"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">CoordSEAc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">CoordSEAc</span><span class="op">)</span></span>
<span><span class="va">CoordSEAc</span><span class="op">$</span><span class="va">coordY</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">CoordSEAc</span><span class="op">$</span><span class="va">coordY</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">CoordSEAc</span><span class="op">$</span><span class="va">coordX</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">CoordSEAc</span><span class="op">$</span><span class="va">coordX</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">CoordSEAc</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 'data.frame':    18772 obs. of  3 variables:</span></span>
<span><span class="co">##  $ Pop   : chr  "P01.Agile frog" "P01.Agile frog" "P01.Agile frog" "P01.Agile frog" ...</span></span>
<span><span class="co">##  $ coordY: num  2.24 2.24 2.24 2.23 2.23 ...</span></span>
<span><span class="co">##  $ coordX: num  -0.343 -0.34 -0.338 -0.335 -0.333 ...</span></span></code></pre>
<div class="sourceCode" id="cb78"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">CoordSEAc</span><span class="op">$</span><span class="va">Pond</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"\\..*"</span>,<span class="st">""</span>,<span class="va">CoordSEAc</span><span class="op">$</span><span class="va">Pop</span><span class="op">)</span></span>
<span><span class="va">CoordSEAc</span><span class="op">$</span><span class="va">Species</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">".*\\."</span>,<span class="st">""</span>,<span class="va">CoordSEAc</span><span class="op">$</span><span class="va">Pop</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">CoordSEAc</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##              Pop   coordY     coordX Pond    Species</span></span>
<span><span class="co">## 1 P01.Agile frog 2.244633 -0.3429006  P01 Agile frog</span></span>
<span><span class="co">## 2 P01.Agile frog 2.241196 -0.3402166  P01 Agile frog</span></span>
<span><span class="co">## 3 P01.Agile frog 2.237761 -0.3376134  P01 Agile frog</span></span>
<span><span class="co">## 4 P01.Agile frog 2.234329 -0.3350917  P01 Agile frog</span></span>
<span><span class="co">## 5 P01.Agile frog 2.230900 -0.3326524  P01 Agile frog</span></span>
<span><span class="co">## 6 P01.Agile frog 2.227475 -0.3302961  P01 Agile frog</span></span></code></pre>
<div class="sourceCode" id="cb80"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">CoordSEAc</span><span class="op">$</span><span class="va">Pond</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">CoordSEAc</span><span class="op">$</span><span class="va">Pond</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">CoordSEAc</span><span class="op">$</span><span class="va">Pond</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##  [1] "P01" "P02" "P03" "P04" "P05" "P06" "P07" "P08" "P09" "P10" "P11" "P12"</span></span>
<span><span class="co">## [13] "P13" "P14" "P15" "P16" "P17" "P18"</span></span></code></pre>
<div class="sourceCode" id="cb82"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.csv</a></span><span class="op">(</span><span class="va">CoordSEAc</span>, </span>
<span>          <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"exported_data"</span>, <span class="st">"Coordinates_SEAc_populations.csv"</span><span class="op">)</span>, </span>
<span>          row.names <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## For the table corresponding to the ellipses separated by juvenile and adult crayfish, save it in the following file:</span></span>
<span><span class="co"># write.csv(CoordSEAc, </span></span>
<span><span class="co">#           file.path(here(), "exported_data", "Coordinates_SEAc_ontogeneticshift.csv"), </span></span>
<span><span class="co">#           row.names = F)</span></span></code></pre></div>
<p>Calculate the mean position of standard ellipses (centroids) at the
pond level</p>
<div class="sourceCode" id="cb83"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Mean_position</span> <span class="op">&lt;-</span> <span class="va">CoordSEAc</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">Pond</span>, <span class="va">Species</span>, <span class="va">Pop</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>TPavg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">coordY</span><span class="op">)</span>,</span>
<span>            D13Cavg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">coordX</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## `summarise()` has grouped output by 'Pond', 'Species'. You can override using</span></span>
<span><span class="co">## the `.groups` argument.</span></span></code></pre>
<div class="sourceCode" id="cb85"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.csv</a></span><span class="op">(</span><span class="va">Mean_position</span>, <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"exported_data"</span>, </span>
<span>                                   <span class="st">"Meanposition_SEAc.csv"</span><span class="op">)</span>, row.names <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="b--ellipse-areas-and-overlap-at-the-pond-scale">b- Ellipse areas and overlap at the pond scale<a class="anchor" aria-label="anchor" href="#b--ellipse-areas-and-overlap-at-the-pond-scale"></a>
</h3>
<p>Calculate the area and percentage of ellipse overlap at the
population level</p>
<div class="sourceCode" id="cb86"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Split dataset by species</span></span>
<span><span class="va">Crayfish</span> <span class="op">&lt;-</span> <span class="va">Dataset</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Species</span> <span class="op">==</span> <span class="st">"Crayfish"</span><span class="op">)</span></span>
<span><span class="va">Treefrog</span> <span class="op">&lt;-</span> <span class="va">Dataset</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Species</span> <span class="op">==</span> <span class="st">"Tree frog"</span><span class="op">)</span></span>
<span><span class="va">Agilefrog</span> <span class="op">&lt;-</span> <span class="va">Dataset</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Species</span> <span class="op">==</span> <span class="st">"Agile frog"</span><span class="op">)</span> </span>
<span><span class="va">Palmatenewt</span> <span class="op">&lt;-</span> <span class="va">Dataset</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Species</span> <span class="op">==</span> <span class="st">"Palmate newt"</span><span class="op">)</span></span>
<span><span class="va">Marblednewt</span> <span class="op">&lt;-</span> <span class="va">Dataset</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Species</span> <span class="op">==</span> <span class="st">"Marbled newt"</span><span class="op">)</span> </span>
<span></span>
<span></span>
<span><span class="co">#For each species, split dataset by pond</span></span>
<span><span class="va">spx_Agilefrog</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/split.html" class="external-link">split</a></span><span class="op">(</span><span class="va">Agilefrog</span><span class="op">$</span><span class="va">D13Ccor_consoI</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">Agilefrog</span><span class="op">$</span><span class="va">Pond</span><span class="op">)</span>, </span>
<span>                       drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">spy_Agilefrog</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/split.html" class="external-link">split</a></span><span class="op">(</span><span class="va">Agilefrog</span><span class="op">$</span><span class="va">TP</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">Agilefrog</span><span class="op">$</span><span class="va">Pond</span><span class="op">)</span>, </span>
<span>                       drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">spx_Treefrog</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/split.html" class="external-link">split</a></span><span class="op">(</span><span class="va">Treefrog</span><span class="op">$</span><span class="va">D13Ccor_consoI</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">Treefrog</span><span class="op">$</span><span class="va">Pond</span><span class="op">)</span>, </span>
<span>                       drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">spy_Treefrog</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/split.html" class="external-link">split</a></span><span class="op">(</span><span class="va">Treefrog</span><span class="op">$</span><span class="va">TP</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">Treefrog</span><span class="op">$</span><span class="va">Pond</span><span class="op">)</span>, </span>
<span>                       drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">spx_Palmatenewt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/split.html" class="external-link">split</a></span><span class="op">(</span><span class="va">Palmatenewt</span><span class="op">$</span><span class="va">D13Ccor_consoI</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">Palmatenewt</span><span class="op">$</span><span class="va">Pond</span><span class="op">)</span>, </span>
<span>                       drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">spy_Palmatenewt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/split.html" class="external-link">split</a></span><span class="op">(</span><span class="va">Palmatenewt</span><span class="op">$</span><span class="va">TP</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">Palmatenewt</span><span class="op">$</span><span class="va">Pond</span><span class="op">)</span>, </span>
<span>                       drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">spx_Marblednewt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/split.html" class="external-link">split</a></span><span class="op">(</span><span class="va">Marblednewt</span><span class="op">$</span><span class="va">D13Ccor_consoI</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">Marblednewt</span><span class="op">$</span><span class="va">Pond</span><span class="op">)</span>, </span>
<span>                       drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">spy_Marblednewt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/split.html" class="external-link">split</a></span><span class="op">(</span><span class="va">Marblednewt</span><span class="op">$</span><span class="va">TP</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">Marblednewt</span><span class="op">$</span><span class="va">Pond</span><span class="op">)</span>, </span>
<span>                       drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">spx_Crayfish</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/split.html" class="external-link">split</a></span><span class="op">(</span><span class="va">Crayfish</span><span class="op">$</span><span class="va">D13Ccor_consoI</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">Crayfish</span><span class="op">$</span><span class="va">Pond</span><span class="op">)</span>, </span>
<span>                       drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">spy_Crayfish</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/split.html" class="external-link">split</a></span><span class="op">(</span><span class="va">Crayfish</span><span class="op">$</span><span class="va">TP</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">Crayfish</span><span class="op">$</span><span class="va">Pond</span><span class="op">)</span>, </span>
<span>                       drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Initialize vectors</span></span>
<span><span class="va">Pond</span> <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="va">Species1</span> <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="va">Species2</span> <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="va">AreaOverlap</span> <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="va">AreaSp1</span> <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="va">AreaSp2</span> <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="va">Table</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Loop over all crayfish-amphibian pairs</p>
<div class="sourceCode" id="cb87"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">spx_Crayfish</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">spx_Agilefrog</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">!=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">Pond</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/append.html" class="external-link">append</a></span><span class="op">(</span><span class="va">Pond</span>, <span class="va">i</span>, after <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">Pond</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">Species1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/append.html" class="external-link">append</a></span><span class="op">(</span><span class="va">Species1</span>, <span class="st">"Crayfish"</span>, after <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">Species1</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">Species2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/append.html" class="external-link">append</a></span><span class="op">(</span><span class="va">Species2</span>, <span class="st">"Agile frog"</span>, after <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">Species2</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">Overlap</span> <span class="op">&lt;-</span> <span class="fu">siar</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/siar/man/overlap.html" class="external-link">overlap</a></span><span class="op">(</span><span class="va">spx_Crayfish</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>, <span class="va">spy_Crayfish</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>,</span>
<span>                             <span class="va">spx_Agilefrog</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>, <span class="va">spy_Agilefrog</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>, steps<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span>    <span class="va">AreaOverlap</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/append.html" class="external-link">append</a></span><span class="op">(</span><span class="va">AreaOverlap</span>, <span class="va">Overlap</span><span class="op">$</span><span class="va">overlap</span>, after <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">AreaOverlap</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">AreaSp1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/append.html" class="external-link">append</a></span><span class="op">(</span><span class="va">AreaSp1</span>, <span class="va">Overlap</span><span class="op">$</span><span class="va">area1</span>, after <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">AreaSp1</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">AreaSp2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/append.html" class="external-link">append</a></span><span class="op">(</span><span class="va">AreaSp2</span>, <span class="va">Overlap</span><span class="op">$</span><span class="va">area2</span>, after <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">AreaSp2</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">spx_Treefrog</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">!=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">Pond</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/append.html" class="external-link">append</a></span><span class="op">(</span><span class="va">Pond</span>, <span class="va">i</span>, after <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">Pond</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">Species1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/append.html" class="external-link">append</a></span><span class="op">(</span><span class="va">Species1</span>, <span class="st">"Crayfish"</span>, after <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">Species1</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">Species2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/append.html" class="external-link">append</a></span><span class="op">(</span><span class="va">Species2</span>, <span class="st">"Tree frog"</span>, after <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">Species2</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">Overlap</span> <span class="op">&lt;-</span> <span class="fu">siar</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/siar/man/overlap.html" class="external-link">overlap</a></span><span class="op">(</span><span class="va">spx_Crayfish</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>, <span class="va">spy_Crayfish</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>,</span>
<span>                             <span class="va">spx_Treefrog</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>, <span class="va">spy_Treefrog</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>, steps<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span>    <span class="va">AreaOverlap</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/append.html" class="external-link">append</a></span><span class="op">(</span><span class="va">AreaOverlap</span>, <span class="va">Overlap</span><span class="op">$</span><span class="va">overlap</span>, after <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">AreaOverlap</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">AreaSp1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/append.html" class="external-link">append</a></span><span class="op">(</span><span class="va">AreaSp1</span>, <span class="va">Overlap</span><span class="op">$</span><span class="va">area1</span>, after <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">AreaSp1</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">AreaSp2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/append.html" class="external-link">append</a></span><span class="op">(</span><span class="va">AreaSp2</span>, <span class="va">Overlap</span><span class="op">$</span><span class="va">area2</span>, after <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">AreaSp2</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">spx_Palmatenewt</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">!=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">Pond</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/append.html" class="external-link">append</a></span><span class="op">(</span><span class="va">Pond</span>, <span class="va">i</span>, after <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">Pond</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">Species1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/append.html" class="external-link">append</a></span><span class="op">(</span><span class="va">Species1</span>, <span class="st">"Crayfish"</span>, after <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">Species1</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">Species2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/append.html" class="external-link">append</a></span><span class="op">(</span><span class="va">Species2</span>, <span class="st">"Palmate newt"</span>, after <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">Species2</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">Overlap</span> <span class="op">&lt;-</span> <span class="fu">siar</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/siar/man/overlap.html" class="external-link">overlap</a></span><span class="op">(</span><span class="va">spx_Crayfish</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>, <span class="va">spy_Crayfish</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>,</span>
<span>                             <span class="va">spx_Palmatenewt</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>, <span class="va">spy_Palmatenewt</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>, steps<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span>    <span class="va">AreaOverlap</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/append.html" class="external-link">append</a></span><span class="op">(</span><span class="va">AreaOverlap</span>, <span class="va">Overlap</span><span class="op">$</span><span class="va">overlap</span>, after <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">AreaOverlap</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">AreaSp1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/append.html" class="external-link">append</a></span><span class="op">(</span><span class="va">AreaSp1</span>, <span class="va">Overlap</span><span class="op">$</span><span class="va">area1</span>, after <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">AreaSp1</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">AreaSp2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/append.html" class="external-link">append</a></span><span class="op">(</span><span class="va">AreaSp2</span>, <span class="va">Overlap</span><span class="op">$</span><span class="va">area2</span>, after <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">AreaSp2</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">spx_Marblednewt</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">!=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">Pond</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/append.html" class="external-link">append</a></span><span class="op">(</span><span class="va">Pond</span>, <span class="va">i</span>, after <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">Pond</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">Species1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/append.html" class="external-link">append</a></span><span class="op">(</span><span class="va">Species1</span>, <span class="st">"Crayfish"</span>, after <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">Species1</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">Species2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/append.html" class="external-link">append</a></span><span class="op">(</span><span class="va">Species2</span>, <span class="st">"Marbled newt"</span>, after <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">Species2</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">Overlap</span> <span class="op">&lt;-</span> <span class="fu">siar</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/siar/man/overlap.html" class="external-link">overlap</a></span><span class="op">(</span><span class="va">spx_Crayfish</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>, <span class="va">spy_Crayfish</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>,</span>
<span>                             <span class="va">spx_Marblednewt</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>, <span class="va">spy_Marblednewt</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>, steps<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span>    <span class="va">AreaOverlap</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/append.html" class="external-link">append</a></span><span class="op">(</span><span class="va">AreaOverlap</span>, <span class="va">Overlap</span><span class="op">$</span><span class="va">overlap</span>, after <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">AreaOverlap</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">AreaSp1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/append.html" class="external-link">append</a></span><span class="op">(</span><span class="va">AreaSp1</span>, <span class="va">Overlap</span><span class="op">$</span><span class="va">area1</span>, after <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">AreaSp1</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">AreaSp2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/append.html" class="external-link">append</a></span><span class="op">(</span><span class="va">AreaSp2</span>, <span class="va">Overlap</span><span class="op">$</span><span class="va">area2</span>, after <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">AreaSp2</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Loop between amphibian species pairs</p>
<div class="sourceCode" id="cb88"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">spx_Agilefrog</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">spx_Treefrog</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">!=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">Pond</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/append.html" class="external-link">append</a></span><span class="op">(</span><span class="va">Pond</span>, <span class="va">i</span>, after <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">Pond</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">Species1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/append.html" class="external-link">append</a></span><span class="op">(</span><span class="va">Species1</span>, <span class="st">"Agile frog"</span>, after <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">Species1</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">Species2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/append.html" class="external-link">append</a></span><span class="op">(</span><span class="va">Species2</span>, <span class="st">"Tree frog"</span>, after <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">Species2</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">Overlap</span> <span class="op">&lt;-</span> <span class="fu">siar</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/siar/man/overlap.html" class="external-link">overlap</a></span><span class="op">(</span><span class="va">spx_Agilefrog</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>, <span class="va">spy_Agilefrog</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>,</span>
<span>                             <span class="va">spx_Treefrog</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>, <span class="va">spy_Treefrog</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>, steps<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span>    <span class="va">AreaOverlap</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/append.html" class="external-link">append</a></span><span class="op">(</span><span class="va">AreaOverlap</span>, <span class="va">Overlap</span><span class="op">$</span><span class="va">overlap</span>, after <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">AreaOverlap</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">AreaSp1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/append.html" class="external-link">append</a></span><span class="op">(</span><span class="va">AreaSp1</span>, <span class="va">Overlap</span><span class="op">$</span><span class="va">area1</span>, after <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">AreaSp1</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">AreaSp2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/append.html" class="external-link">append</a></span><span class="op">(</span><span class="va">AreaSp2</span>, <span class="va">Overlap</span><span class="op">$</span><span class="va">area2</span>, after <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">AreaSp2</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">spx_Palmatenewt</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">!=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">Pond</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/append.html" class="external-link">append</a></span><span class="op">(</span><span class="va">Pond</span>, <span class="va">i</span>, after <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">Pond</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">Species1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/append.html" class="external-link">append</a></span><span class="op">(</span><span class="va">Species1</span>, <span class="st">"Agile frog"</span>, after <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">Species1</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">Species2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/append.html" class="external-link">append</a></span><span class="op">(</span><span class="va">Species2</span>, <span class="st">"Palmate newt"</span>, after <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">Species2</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">Overlap</span> <span class="op">&lt;-</span> <span class="fu">siar</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/siar/man/overlap.html" class="external-link">overlap</a></span><span class="op">(</span><span class="va">spx_Agilefrog</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>, <span class="va">spy_Agilefrog</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>,</span>
<span>                             <span class="va">spx_Palmatenewt</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>, <span class="va">spy_Palmatenewt</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>, steps<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span>    <span class="va">AreaOverlap</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/append.html" class="external-link">append</a></span><span class="op">(</span><span class="va">AreaOverlap</span>, <span class="va">Overlap</span><span class="op">$</span><span class="va">overlap</span>, after <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">AreaOverlap</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">AreaSp1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/append.html" class="external-link">append</a></span><span class="op">(</span><span class="va">AreaSp1</span>, <span class="va">Overlap</span><span class="op">$</span><span class="va">area1</span>, after <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">AreaSp1</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">AreaSp2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/append.html" class="external-link">append</a></span><span class="op">(</span><span class="va">AreaSp2</span>, <span class="va">Overlap</span><span class="op">$</span><span class="va">area2</span>, after <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">AreaSp2</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">spx_Marblednewt</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">!=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">Pond</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/append.html" class="external-link">append</a></span><span class="op">(</span><span class="va">Pond</span>, <span class="va">i</span>, after <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">Pond</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">Species1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/append.html" class="external-link">append</a></span><span class="op">(</span><span class="va">Species1</span>, <span class="st">"Agile frog"</span>, after <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">Species1</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">Species2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/append.html" class="external-link">append</a></span><span class="op">(</span><span class="va">Species2</span>, <span class="st">"Marbled newt"</span>, after <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">Species2</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">Overlap</span> <span class="op">&lt;-</span> <span class="fu">siar</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/siar/man/overlap.html" class="external-link">overlap</a></span><span class="op">(</span><span class="va">spx_Agilefrog</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>, <span class="va">spy_Agilefrog</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>,</span>
<span>                             <span class="va">spx_Marblednewt</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>, <span class="va">spy_Marblednewt</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>, steps<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span>    <span class="va">AreaOverlap</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/append.html" class="external-link">append</a></span><span class="op">(</span><span class="va">AreaOverlap</span>, <span class="va">Overlap</span><span class="op">$</span><span class="va">overlap</span>, after <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">AreaOverlap</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">AreaSp1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/append.html" class="external-link">append</a></span><span class="op">(</span><span class="va">AreaSp1</span>, <span class="va">Overlap</span><span class="op">$</span><span class="va">area1</span>, after <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">AreaSp1</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">AreaSp2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/append.html" class="external-link">append</a></span><span class="op">(</span><span class="va">AreaSp2</span>, <span class="va">Overlap</span><span class="op">$</span><span class="va">area2</span>, after <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">AreaSp2</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">spx_Treefrog</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">spx_Palmatenewt</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">!=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">Pond</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/append.html" class="external-link">append</a></span><span class="op">(</span><span class="va">Pond</span>, <span class="va">i</span>, after <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">Pond</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">Species1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/append.html" class="external-link">append</a></span><span class="op">(</span><span class="va">Species1</span>, <span class="st">"Tree frog"</span>, after <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">Species1</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">Species2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/append.html" class="external-link">append</a></span><span class="op">(</span><span class="va">Species2</span>, <span class="st">"Palmate newt"</span>, after <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">Species2</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">Overlap</span> <span class="op">&lt;-</span> <span class="fu">siar</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/siar/man/overlap.html" class="external-link">overlap</a></span><span class="op">(</span><span class="va">spx_Treefrog</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>, <span class="va">spy_Treefrog</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>,</span>
<span>                             <span class="va">spx_Palmatenewt</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>, <span class="va">spy_Palmatenewt</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>, steps<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span>    <span class="va">AreaOverlap</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/append.html" class="external-link">append</a></span><span class="op">(</span><span class="va">AreaOverlap</span>, <span class="va">Overlap</span><span class="op">$</span><span class="va">overlap</span>, after <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">AreaOverlap</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">AreaSp1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/append.html" class="external-link">append</a></span><span class="op">(</span><span class="va">AreaSp1</span>, <span class="va">Overlap</span><span class="op">$</span><span class="va">area1</span>, after <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">AreaSp1</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">AreaSp2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/append.html" class="external-link">append</a></span><span class="op">(</span><span class="va">AreaSp2</span>, <span class="va">Overlap</span><span class="op">$</span><span class="va">area2</span>, after <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">AreaSp2</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">spx_Marblednewt</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">!=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">Pond</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/append.html" class="external-link">append</a></span><span class="op">(</span><span class="va">Pond</span>, <span class="va">i</span>, after <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">Pond</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">Species1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/append.html" class="external-link">append</a></span><span class="op">(</span><span class="va">Species1</span>, <span class="st">"Tree frog"</span>, after <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">Species1</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">Species2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/append.html" class="external-link">append</a></span><span class="op">(</span><span class="va">Species2</span>, <span class="st">"Marbled newt"</span>, after <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">Species2</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">Overlap</span> <span class="op">&lt;-</span> <span class="fu">siar</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/siar/man/overlap.html" class="external-link">overlap</a></span><span class="op">(</span><span class="va">spx_Treefrog</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>, <span class="va">spy_Treefrog</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>,</span>
<span>                             <span class="va">spx_Marblednewt</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>, <span class="va">spy_Marblednewt</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>, steps<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span>    <span class="va">AreaOverlap</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/append.html" class="external-link">append</a></span><span class="op">(</span><span class="va">AreaOverlap</span>, <span class="va">Overlap</span><span class="op">$</span><span class="va">overlap</span>, after <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">AreaOverlap</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">AreaSp1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/append.html" class="external-link">append</a></span><span class="op">(</span><span class="va">AreaSp1</span>, <span class="va">Overlap</span><span class="op">$</span><span class="va">area1</span>, after <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">AreaSp1</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">AreaSp2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/append.html" class="external-link">append</a></span><span class="op">(</span><span class="va">AreaSp2</span>, <span class="va">Overlap</span><span class="op">$</span><span class="va">area2</span>, after <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">AreaSp2</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">spx_Palmatenewt</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">spx_Marblednewt</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">!=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">Pond</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/append.html" class="external-link">append</a></span><span class="op">(</span><span class="va">Pond</span>, <span class="va">i</span>, after <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">Pond</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">Species1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/append.html" class="external-link">append</a></span><span class="op">(</span><span class="va">Species1</span>, <span class="st">"Palmate newt"</span>, after <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">Species1</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">Species2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/append.html" class="external-link">append</a></span><span class="op">(</span><span class="va">Species2</span>, <span class="st">"Marbled newt"</span>, after <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">Species2</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">Overlap</span> <span class="op">&lt;-</span> <span class="fu">siar</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/siar/man/overlap.html" class="external-link">overlap</a></span><span class="op">(</span><span class="va">spx_Palmatenewt</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>, <span class="va">spy_Palmatenewt</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>,</span>
<span>                             <span class="va">spx_Marblednewt</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>, <span class="va">spy_Marblednewt</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>, steps<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span>    <span class="va">AreaOverlap</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/append.html" class="external-link">append</a></span><span class="op">(</span><span class="va">AreaOverlap</span>, <span class="va">Overlap</span><span class="op">$</span><span class="va">overlap</span>, after <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">AreaOverlap</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">AreaSp1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/append.html" class="external-link">append</a></span><span class="op">(</span><span class="va">AreaSp1</span>, <span class="va">Overlap</span><span class="op">$</span><span class="va">area1</span>, after <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">AreaSp1</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">AreaSp2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/append.html" class="external-link">append</a></span><span class="op">(</span><span class="va">AreaSp2</span>, <span class="va">Overlap</span><span class="op">$</span><span class="va">area2</span>, after <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">AreaSp2</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Merge results in a table and export it</p>
<div class="sourceCode" id="cb89"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">Pond</span>, <span class="va">Species1</span>, <span class="va">Species2</span>, AreaOverlap <span class="op">=</span> <span class="va">AreaOverlap</span>, </span>
<span>             AreaSp1 <span class="op">=</span> <span class="va">AreaSp1</span>, AreaSp2 <span class="op">=</span> <span class="va">AreaSp2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">Table</span><span class="op">)</span></span>
<span><span class="va">Table</span><span class="op">$</span><span class="va">Prct_overlap</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">Table</span><span class="op">$</span><span class="va">AreaOverlap</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">Table</span><span class="op">$</span><span class="va">AreaSp1</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">Table</span><span class="op">$</span><span class="va">AreaSp2</span><span class="op">)</span><span class="op">)</span>,<span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">Table</span><span class="op">$</span><span class="va">Prct_overlap_sp2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">Table</span><span class="op">$</span><span class="va">AreaOverlap</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">Table</span><span class="op">$</span><span class="va">AreaSp2</span><span class="op">)</span>,<span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">Table</span><span class="op">$</span><span class="va">Prct_overlap_sp1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">Table</span><span class="op">$</span><span class="va">AreaOverlap</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">Table</span><span class="op">$</span><span class="va">AreaSp1</span><span class="op">)</span>,<span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">Table</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   Pond Species1     Species2 AreaOverlap            AreaSp1             AreaSp2</span></span>
<span><span class="co">## 1  P05 Crayfish   Agile frog           0  0.088986835353265  0.0242961599666121</span></span>
<span><span class="co">## 2  P07 Crayfish   Agile frog           0 0.0384953627363035 0.00949635912179293</span></span>
<span><span class="co">## 3  P08 Crayfish   Agile frog           0 0.0856231428002137  0.0140580305030633</span></span>
<span><span class="co">## 4  P08 Crayfish Palmate newt           0 0.0856231428002137   0.031359095037802</span></span>
<span><span class="co">## 5  P09 Crayfish   Agile frog           0 0.0290194574148628  0.0253021922477377</span></span>
<span><span class="co">## 6  P09 Crayfish    Tree frog           0 0.0290194574148628  0.0326813436390345</span></span>
<span><span class="co">##   Prct_overlap Prct_overlap_sp2 Prct_overlap_sp1</span></span>
<span><span class="co">## 1            0                0                0</span></span>
<span><span class="co">## 2            0                0                0</span></span>
<span><span class="co">## 3            0                0                0</span></span>
<span><span class="co">## 4            0                0                0</span></span>
<span><span class="co">## 5            0                0                0</span></span>
<span><span class="co">## 6            0                0                0</span></span></code></pre>
<div class="sourceCode" id="cb91"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.csv</a></span><span class="op">(</span><span class="va">Table</span>, <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"exported_data"</span>, <span class="st">"Overlap_populations.csv"</span><span class="op">)</span>, </span>
<span>          row.names <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span></code></pre></div>
<p>Finally, generate a table with all SEAc at the pond scale</p>
<div class="sourceCode" id="cb92"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Dataset_ellipses</span> <span class="op">&lt;-</span> <span class="va">Dataset</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="st">"iso1"</span> <span class="op">=</span> <span class="va">D13Ccor_consoI</span>, <span class="st">"iso2"</span> <span class="op">=</span> <span class="va">TP</span>, <span class="st">"group"</span> <span class="op">=</span> <span class="va">Species</span>, </span>
<span>                <span class="st">"community"</span> <span class="op">=</span> <span class="va">Pond</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Dataset_SIBER</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/SIBER/man/createSiberObject.html" class="external-link">createSiberObject</a></span><span class="op">(</span><span class="va">Dataset_ellipses</span><span class="op">)</span></span>
<span><span class="va">Pop_metrics_SEAc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/SIBER/man/groupMetricsML.html" class="external-link">groupMetricsML</a></span><span class="op">(</span><span class="va">Dataset_SIBER</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Table transformation</span></span>
<span><span class="va">Pop_metrics_ellipses</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">Pop_metrics_SEAc</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">Pop_metrics_ellipses</span><span class="op">$</span><span class="va">Code</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">Pop_metrics_ellipses</span><span class="op">)</span></span>
<span><span class="va">Pop_metrics_ellipses</span><span class="op">$</span><span class="va">Pond</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"[.].*"</span>,<span class="st">""</span>,<span class="va">Pop_metrics_ellipses</span><span class="op">$</span><span class="va">Code</span><span class="op">)</span></span>
<span><span class="va">Pop_metrics_ellipses</span><span class="op">$</span><span class="va">Species</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">".*.[.]"</span>,<span class="st">""</span>,<span class="va">Pop_metrics_ellipses</span><span class="op">$</span><span class="va">Code</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.csv</a></span><span class="op">(</span><span class="va">Pop_metrics_ellipses</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>, </span>
<span>          <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"exported_data"</span>, <span class="st">"Population_metrics.csv"</span><span class="op">)</span>, </span>
<span>          row.names <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="long-table">Long table<a class="anchor" aria-label="anchor" href="#long-table"></a>
</h2>
<p>Generate the long version of this table combining SEAc and mean
position for Supplementary Material</p>
<div class="sourceCode" id="cb93"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Pop_metrics</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"exported_data"</span>, </span>
<span>                                  <span class="st">"Population_metrics.csv"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Mean_position</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"exported_data"</span>, </span>
<span>                                    <span class="st">"Meanposition_SEAc.csv"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">Mean_position</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">=</span> <span class="st">"Code"</span></span>
<span><span class="va">Mean_position</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/compound.html" class="external-link">%&lt;&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">Pond</span>, <span class="op">-</span><span class="va">Species</span><span class="op">)</span> </span>
<span><span class="va">Pop_metrics</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">Pop_metrics</span>, <span class="va">Mean_position</span>, by <span class="op">=</span> <span class="st">"Code"</span><span class="op">)</span></span>
<span><span class="va">Pop_metrics</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/compound.html" class="external-link">%&lt;&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">Pond</span>, <span class="va">Species</span>, <span class="va">SEAc</span>, <span class="va">TPavg</span>, <span class="va">D13Cavg</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Pop_metrics_long</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>      <span class="va">Pop_metrics</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/cast.html" class="external-link">dcast</a></span><span class="op">(</span><span class="va">Pond</span> <span class="op">~</span> <span class="va">Species</span>, value.var <span class="op">=</span> <span class="st">"SEAc"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/add_column.html" class="external-link">add_column</a></span><span class="op">(</span>Metrics <span class="op">=</span> <span class="st">"SEAc"</span><span class="op">)</span>,</span>
<span>      <span class="va">Pop_metrics</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/cast.html" class="external-link">dcast</a></span><span class="op">(</span><span class="va">Pond</span> <span class="op">~</span> <span class="va">Species</span>, value.var <span class="op">=</span> <span class="st">"TPavg"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/add_column.html" class="external-link">add_column</a></span><span class="op">(</span>Metrics <span class="op">=</span> <span class="st">"TPavg"</span><span class="op">)</span>,</span>
<span>      <span class="va">Pop_metrics</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/cast.html" class="external-link">dcast</a></span><span class="op">(</span><span class="va">Pond</span> <span class="op">~</span> <span class="va">Species</span>, value.var <span class="op">=</span> <span class="st">"D13Cavg"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/add_column.html" class="external-link">add_column</a></span><span class="op">(</span>Metrics <span class="op">=</span> <span class="st">"D13Cavg"</span><span class="op">)</span><span class="op">)</span></span>
<span>      </span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.csv</a></span><span class="op">(</span><span class="va">Pop_metrics_long</span>, <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"exported_data"</span>, <span class="st">"Population_metrics_long.csv"</span><span class="op">)</span>, row.names <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span></code></pre></div>
<p>The next step will be to plot these communities.</p>
</div>
<div class="footnotes footnotes-end-of-document">
<hr>
<ol>
<li id="fn1"><p>UMR EcoBio, UMR DECOD, <a href="mailto:nadege.belouard@gmail.com" class="email">nadege.belouard@gmail.com</a><a href="#fnref1" class="footnote-back">â†©ï¸Ž</a></p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by NadÃ¨ge Belouard.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
