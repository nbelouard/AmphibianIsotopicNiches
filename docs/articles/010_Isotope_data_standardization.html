<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>#1: Isotope data standardization • AmphibianIsotopicNiches</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="#1: Isotope data standardization">
<meta property="og:description" content="AmphibianIsotopicNiches">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">AmphibianIsotopicNiches</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/010_Isotope_data_standardization.html">#1: Isotope data standardization</a>
    </li>
    <li>
      <a href="../articles/029_Install_siar_from_archive.html">Install siar from archive</a>
    </li>
    <li>
      <a href="../articles/030_Isotope_metrics.html">#2: Compute niche metrics</a>
    </li>
    <li>
      <a href="../articles/040_Trophic_networks_plots_ellipses.html">#3: Plots stable isotope niches with ellipses</a>
    </li>
    <li>
      <a href="../articles/060_Statistical_models_isotopes.html">#4: Compute statistical models</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>#1: Isotope data standardization</h1>
                        <h4 data-toc-skip class="author">Nadege
Belouard<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>
</h4>
            
            <h4 data-toc-skip class="date">03/06/2024</h4>
      
      
      <div class="hidden name"><code>010_Isotope_data_standardization.Rmd</code></div>

    </div>

    
    
<p>The purpose of this first vignette is to complete the stable isotope
data transformation from raw data to standardized data to be used in
stable isotope niche calculations. Data standardization will allow
comparison between different ecosystems.</p>
<p>First, we load the packages that we are going to use for this
vignette.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://yihui.org/knitr/" class="external-link">knitr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org" class="external-link">magrittr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://here.r-lib.org/" class="external-link">here</a></span><span class="op">)</span></span></code></pre></div>
<p>We then load the raw dataset and have a look at it.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Dataset</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"data_raw"</span>, <span class="st">"Raw_data.csv"</span><span class="op">)</span>, header<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span>
<span><span class="va">Dataset</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<table style="width:100%;" class="table">
<colgroup>
<col width="7%">
<col width="14%">
<col width="14%">
<col width="15%">
<col width="14%">
<col width="10%">
<col width="7%">
<col width="10%">
<col width="7%">
</colgroup>
<thead><tr class="header">
<th align="left">Pond</th>
<th align="left">Taxa</th>
<th align="left">Species</th>
<th align="left">Group</th>
<th align="left">Sample_ID</th>
<th align="right">Weight</th>
<th align="right">D15N</th>
<th align="right">D13C</th>
<th align="right">C.N</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">P02</td>
<td align="left">Tree frog</td>
<td align="left">Tree frog</td>
<td align="left">Amphibians</td>
<td align="left">22RVER11</td>
<td align="right">0.2658</td>
<td align="right">1.20</td>
<td align="right">-24.12</td>
<td align="right">3.63</td>
</tr>
<tr class="even">
<td align="left">P02</td>
<td align="left">Tree frog</td>
<td align="left">Tree frog</td>
<td align="left">Amphibians</td>
<td align="left">22RVER15</td>
<td align="right">0.4167</td>
<td align="right">1.42</td>
<td align="right">-25.12</td>
<td align="right">3.69</td>
</tr>
<tr class="odd">
<td align="left">P02</td>
<td align="left">Tree frog</td>
<td align="left">Tree frog</td>
<td align="left">Amphibians</td>
<td align="left">22RVER1</td>
<td align="right">0.3343</td>
<td align="right">1.72</td>
<td align="right">-23.27</td>
<td align="right">3.61</td>
</tr>
<tr class="even">
<td align="left">P02</td>
<td align="left">Tree frog</td>
<td align="left">Tree frog</td>
<td align="left">Amphibians</td>
<td align="left">22RVER19</td>
<td align="right">0.3905</td>
<td align="right">1.67</td>
<td align="right">-24.48</td>
<td align="right">3.94</td>
</tr>
<tr class="odd">
<td align="left">P02</td>
<td align="left">Tree frog</td>
<td align="left">Tree frog</td>
<td align="left">Amphibians</td>
<td align="left">22RVER13</td>
<td align="right">0.2640</td>
<td align="right">1.15</td>
<td align="right">-25.26</td>
<td align="right">3.62</td>
</tr>
<tr class="even">
<td align="left">P02</td>
<td align="left">Tree frog</td>
<td align="left">Tree frog</td>
<td align="left">Amphibians</td>
<td align="left">22RVER4</td>
<td align="right">0.3265</td>
<td align="right">1.55</td>
<td align="right">-23.31</td>
<td align="right">3.52</td>
</tr>
</tbody>
</table>
<p>The dataset contains the pond code, sample taxa (species x life
stage), species and group (amphibians, crayfish, baseline consumers),
sample ID and weight, and finally stable isotope values in the columns
“D15N” and “D13C”, with the C/N ratio in the last column.</p>
<p>We generate a few useful tables: Detail of the number of samples per
taxa per pond</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">Dataset</span><span class="op">$</span><span class="va">Pond</span>, <span class="va">Dataset</span><span class="op">$</span><span class="va">Taxa</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##      </span></span>
<span><span class="co">##       Ad crayfish Agile frog Asellus Corbiculidae Corixidae Gammarus</span></span>
<span><span class="co">##   P01           0         20       3            1         3        0</span></span>
<span><span class="co">##   P02           0          9       3            0         3        0</span></span>
<span><span class="co">##   P03           0         20       0            0         2        0</span></span>
<span><span class="co">##   P04           0         20       0            3         3        0</span></span>
<span><span class="co">##   P05          20         20       2            0         0        3</span></span>
<span><span class="co">##   P06           3         10       3            1         3        3</span></span>
<span><span class="co">##   P07          19         15       2            0         3        0</span></span>
<span><span class="co">##   P08          10         20       0            0         3        3</span></span>
<span><span class="co">##   P09          20         19       0            0         3        3</span></span>
<span><span class="co">##   P10          18         20       2            1         3        3</span></span>
<span><span class="co">##   P11           0         20       0            0         3        0</span></span>
<span><span class="co">##   P12           0         20       2            3         3        3</span></span>
<span><span class="co">##   P13          20          0       0            0         1        3</span></span>
<span><span class="co">##   P14          20         20       3            0         3        3</span></span>
<span><span class="co">##   P15          20         20       0            2         3        3</span></span>
<span><span class="co">##   P16          20         10       0            0         3        0</span></span>
<span><span class="co">##   P17          20          8       3            0         0        3</span></span>
<span><span class="co">##   P18          20          0       0            0         1        3</span></span>
<span><span class="co">##      </span></span>
<span><span class="co">##       Juv crayfish Marbled newt Palmate newt Physa Tree frog Zooplankton</span></span>
<span><span class="co">##   P01            0           19           20     1        19           3</span></span>
<span><span class="co">##   P02            0           19           13     3        20           3</span></span>
<span><span class="co">##   P03            0           16           20     3        15           2</span></span>
<span><span class="co">##   P04            0            7           19     3        20           3</span></span>
<span><span class="co">##   P05           11            0            0     3         0           1</span></span>
<span><span class="co">##   P06            1           20           19     3         0           3</span></span>
<span><span class="co">##   P07            9            0            1     3         0           1</span></span>
<span><span class="co">##   P08           26            2           20     3         0           3</span></span>
<span><span class="co">##   P09            5            0           12     3        20           3</span></span>
<span><span class="co">##   P10           12            6            9     3         0           3</span></span>
<span><span class="co">##   P11            0            9           20     3        20           2</span></span>
<span><span class="co">##   P12            0           11           20     0        20           3</span></span>
<span><span class="co">##   P13           10            0            1     3         0           2</span></span>
<span><span class="co">##   P14           20            0            1     3        20           2</span></span>
<span><span class="co">##   P15           17            0           20     3        14           3</span></span>
<span><span class="co">##   P16            2            0            1     3         0           3</span></span>
<span><span class="co">##   P17            6            0            5     3         0           3</span></span>
<span><span class="co">##   P18           23            0            0     3         0           3</span></span></code></pre>
<p>Calculate the mean sample weight per taxa</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Dataset</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">Group</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>meanweight <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">Weight</span><span class="op">*</span><span class="fl">1000</span><span class="op">)</span>,<span class="fl">0</span><span class="op">)</span>, </span>
<span>            sdweight <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">Weight</span><span class="op">*</span><span class="fl">1000</span><span class="op">)</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">Group</th>
<th align="right">meanweight</th>
<th align="right">sdweight</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Amphibians</td>
<td align="right">378</td>
<td align="right">57</td>
</tr>
<tr class="even">
<td align="left">C1</td>
<td align="right">925</td>
<td align="right">230</td>
</tr>
<tr class="odd">
<td align="left">Crayfish</td>
<td align="right">1012</td>
<td align="right">64</td>
</tr>
</tbody>
</table>
<div class="section level2">
<h2 id="a--data-wrangling">A- Data wrangling<a class="anchor" aria-label="anchor" href="#a--data-wrangling"></a>
</h2>
<div class="section level3">
<h3 id="correction-of-d13c-for-samples-with-high-lipid-content-cn-3-5">1- Correction of D13C for samples with high lipid content (C/N &gt;
3.5)<a class="anchor" aria-label="anchor" href="#correction-of-d13c-for-samples-with-high-lipid-content-cn-3-5"></a>
</h3>
<p>First, let’s have a look at the average C/N for each species.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Dataset</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">Taxa</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>meanCN <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">C.N</span><span class="op">)</span>,</span>
<span>            minCN <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">C.N</span><span class="op">)</span>,</span>
<span>            maxCN <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">C.N</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">Taxa</th>
<th align="right">meanCN</th>
<th align="right">minCN</th>
<th align="right">maxCN</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Ad crayfish</td>
<td align="right">3.141952</td>
<td align="right">3.03</td>
<td align="right">3.62</td>
</tr>
<tr class="even">
<td align="left">Agile frog</td>
<td align="right">3.561033</td>
<td align="right">3.38</td>
<td align="right">3.83</td>
</tr>
<tr class="odd">
<td align="left">Asellus</td>
<td align="right">4.569565</td>
<td align="right">3.90</td>
<td align="right">5.11</td>
</tr>
<tr class="even">
<td align="left">Corbiculidae</td>
<td align="right">4.662727</td>
<td align="right">4.03</td>
<td align="right">6.92</td>
</tr>
<tr class="odd">
<td align="left">Corixidae</td>
<td align="right">4.127209</td>
<td align="right">3.88</td>
<td align="right">4.60</td>
</tr>
<tr class="even">
<td align="left">Gammarus</td>
<td align="right">4.755758</td>
<td align="right">4.35</td>
<td align="right">5.56</td>
</tr>
<tr class="odd">
<td align="left">Juv crayfish</td>
<td align="right">3.251056</td>
<td align="right">3.10</td>
<td align="right">3.96</td>
</tr>
<tr class="even">
<td align="left">Marbled newt</td>
<td align="right">3.404128</td>
<td align="right">3.25</td>
<td align="right">3.59</td>
</tr>
<tr class="odd">
<td align="left">Palmate newt</td>
<td align="right">3.415323</td>
<td align="right">3.12</td>
<td align="right">4.05</td>
</tr>
<tr class="even">
<td align="left">Physa</td>
<td align="right">4.081633</td>
<td align="right">3.77</td>
<td align="right">4.52</td>
</tr>
<tr class="odd">
<td align="left">Tree frog</td>
<td align="right">3.687857</td>
<td align="right">3.40</td>
<td align="right">4.08</td>
</tr>
<tr class="even">
<td align="left">Zooplankton</td>
<td align="right">4.685217</td>
<td align="right">4.19</td>
<td align="right">5.15</td>
</tr>
</tbody>
</table>
<p>Since many of them have C/N higher than 3.5, we need to correct the
D13C for high lipid content for all groups. We use the equation of Post,
2007. The lipid-free D13C is saved in a new column named “D13C_LF”.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Dataset</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/compound.html" class="external-link">%&lt;&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>D13C_LF <span class="op">=</span> <span class="va">D13C</span> <span class="op">-</span> <span class="fl">3.32</span> <span class="op">+</span> <span class="fl">0.99</span> <span class="op">*</span> <span class="va">C.N</span><span class="op">)</span></span></code></pre></div>
<p>And we check that the correction increased D13C by comparing it to y
= x:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">Dataset</span><span class="op">$</span><span class="va">D13C_LF</span> <span class="op">~</span> <span class="va">Dataset</span><span class="op">$</span><span class="va">D13C</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"original D13C"</span>,</span>
<span>     ylab <span class="op">=</span> <span class="st">"corrected D13C"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="010_Isotope_data_standardization_files/figure-html/plot%20the%20D13C%20correction-1.png" width="700"></p>
<pre><code><span><span class="co">## integer(0)</span></span></code></pre>
<p>Corrected D13C are above the y = x line, so it looks ok.</p>
</div>
<div class="section level3">
<h3 id="correction-of-amphibian-fin-values-for-muscle-values">2- Correction of amphibian fin values for muscle values<a class="anchor" aria-label="anchor" href="#correction-of-amphibian-fin-values-for-muscle-values"></a>
</h3>
<p>In accordance with institutional ethics, we sampled amphibian fins
instead of muscle, and need to correct values according to equations
published in Bélouard et al. (2018);</p>
<p>The equations used to correct the <span class="math inline">\(D^{13}C\)</span> values are:<br>
For the agile frog: <span class="math inline">\(D^{13}C_{muscle} = 0.85
\times D^{13}C_{fin} - 5.50\)</span><br>
For the European tree frog: <span class="math inline">\(D^{13}C_{muscle}
= 0.87 \times D^{13}C_{fin} - 4.80\)</span><br>
For the marbled newt: <span class="math inline">\(D^{13}C_{muscle} =
0.70 \times D^{13}C_{fin} - 7.43\)</span><br>
For the palmate newt: <span class="math inline">\(D^{13}C_{muscle} =
0.71 \times D^{13}C_{fin} - 7.03\)</span></p>
<p>The equations used to correct the <span class="math inline">\(D^{15}N\)</span> values are:<br>
For the agile frog: <span class="math inline">\(D^{15}N_{muscle} = 0.86
\times D^{15}N_{fin} + 0.97\)</span><br>
For the European tree frog: <span class="math inline">\(D^{15}N_{muscle}
= 1.04 \times D^{15}N_{fin} + 0.67\)</span><br>
For the marbled newt: <span class="math inline">\(D^{15}N_{muscle} =
1.01 \times D^{15}N_{fin} - 0.48\)</span><br>
For the palmate newt: <span class="math inline">\(D^{15}N_{muscle} =
0.89 \times D^{15}N_{fin} + 0.40\)</span></p>
<p>Values corrected for this translation are stored in two new columns:
D13C_LFMu and D15N_Mu.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">Dataset</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">Dataset</span><span class="op">$</span><span class="va">Taxa</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">==</span> <span class="st">"Agile frog"</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">Dataset</span><span class="op">$</span><span class="va">D13C_LFMu</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="fl">0.85</span> <span class="op">*</span> <span class="va">Dataset</span><span class="op">$</span><span class="va">D13C_LF</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">-</span><span class="fl">5.50</span></span>
<span>    <span class="va">Dataset</span><span class="op">$</span><span class="va">D15N_Mu</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="fl">0.86</span> <span class="op">*</span> <span class="va">Dataset</span><span class="op">$</span><span class="va">D15N</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">+</span> <span class="fl">0.97</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">Dataset</span><span class="op">$</span><span class="va">Taxa</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">==</span> <span class="st">"Tree frog"</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">Dataset</span><span class="op">$</span><span class="va">D13C_LFMu</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="fl">0.87</span> <span class="op">*</span> <span class="va">Dataset</span><span class="op">$</span><span class="va">D13C_LF</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">-</span><span class="fl">4.80</span></span>
<span>    <span class="va">Dataset</span><span class="op">$</span><span class="va">D15N_Mu</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="fl">1.04</span> <span class="op">*</span> <span class="va">Dataset</span><span class="op">$</span><span class="va">D15N</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">+</span> <span class="fl">0.67</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">Dataset</span><span class="op">$</span><span class="va">Taxa</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">==</span> <span class="st">"Marbled newt"</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">Dataset</span><span class="op">$</span><span class="va">D13C_LFMu</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="fl">0.70</span> <span class="op">*</span> <span class="va">Dataset</span><span class="op">$</span><span class="va">D13C_LF</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">-</span> <span class="fl">7.43</span></span>
<span>    <span class="va">Dataset</span><span class="op">$</span><span class="va">D15N_Mu</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="fl">1.01</span> <span class="op">*</span> <span class="va">Dataset</span><span class="op">$</span><span class="va">D15N</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">-</span> <span class="fl">0.48</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">Dataset</span><span class="op">$</span><span class="va">Taxa</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">==</span> <span class="st">"Palmate newt"</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">Dataset</span><span class="op">$</span><span class="va">D13C_LFMu</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="fl">0.71</span> <span class="op">*</span> <span class="va">Dataset</span><span class="op">$</span><span class="va">D13C_LF</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">-</span> <span class="fl">7.03</span></span>
<span>    <span class="va">Dataset</span><span class="op">$</span><span class="va">D15N_Mu</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="fl">0.89</span> <span class="op">*</span> <span class="va">Dataset</span><span class="op">$</span><span class="va">D15N</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">+</span> <span class="fl">0.40</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span> </span>
<span>    <span class="va">Dataset</span><span class="op">$</span><span class="va">D13C_LFMu</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="va">Dataset</span><span class="op">$</span><span class="va">D13C_LF</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span>    <span class="va">Dataset</span><span class="op">$</span><span class="va">D15N_Mu</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="va">Dataset</span><span class="op">$</span><span class="va">D15N</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="b---data-standardization">B - Data standardization<a class="anchor" aria-label="anchor" href="#b---data-standardization"></a>
</h2>
<p>We need primary consumers to serve as a baseline to standardize the
isotopic values. Candidate taxa are: clams (Corbiculidae), Physa,
Gammarus, Corixidae, Asellus, and zooplankton. Here are the sample sizes
for each pond.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="va">Dataset</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Taxa</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Corbiculidae"</span>, <span class="st">"Physa"</span>, <span class="st">"Zooplankton"</span>, <span class="st">"Gammarus"</span>,</span>
<span>                            <span class="st">"Corixidae"</span>, <span class="st">"Asellus"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">Taxa</span>, <span class="va">Pond</span><span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/spread.html" class="external-link">spread</a></span><span class="op">(</span><span class="va">Pond</span>, <span class="va">n</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre></div>
<table style="width:100%;" class="table">
<colgroup>
<col width="15%">
<col width="4%">
<col width="4%">
<col width="4%">
<col width="4%">
<col width="4%">
<col width="4%">
<col width="4%">
<col width="4%">
<col width="4%">
<col width="4%">
<col width="4%">
<col width="4%">
<col width="4%">
<col width="4%">
<col width="4%">
<col width="4%">
<col width="4%">
<col width="4%">
</colgroup>
<thead><tr class="header">
<th align="left">Taxa</th>
<th align="right">P01</th>
<th align="right">P02</th>
<th align="right">P03</th>
<th align="right">P04</th>
<th align="right">P05</th>
<th align="right">P06</th>
<th align="right">P07</th>
<th align="right">P08</th>
<th align="right">P09</th>
<th align="right">P10</th>
<th align="right">P11</th>
<th align="right">P12</th>
<th align="right">P13</th>
<th align="right">P14</th>
<th align="right">P15</th>
<th align="right">P16</th>
<th align="right">P17</th>
<th align="right">P18</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Asellus</td>
<td align="right">3</td>
<td align="right">3</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">2</td>
<td align="right">3</td>
<td align="right">2</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">2</td>
<td align="right">NA</td>
<td align="right">2</td>
<td align="right">NA</td>
<td align="right">3</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">3</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">Corbiculidae</td>
<td align="right">1</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">3</td>
<td align="right">NA</td>
<td align="right">1</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">1</td>
<td align="right">NA</td>
<td align="right">3</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">2</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">Corixidae</td>
<td align="right">3</td>
<td align="right">3</td>
<td align="right">2</td>
<td align="right">3</td>
<td align="right">NA</td>
<td align="right">3</td>
<td align="right">3</td>
<td align="right">3</td>
<td align="right">3</td>
<td align="right">3</td>
<td align="right">3</td>
<td align="right">3</td>
<td align="right">1</td>
<td align="right">3</td>
<td align="right">3</td>
<td align="right">3</td>
<td align="right">NA</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">Gammarus</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">3</td>
<td align="right">3</td>
<td align="right">NA</td>
<td align="right">3</td>
<td align="right">3</td>
<td align="right">3</td>
<td align="right">NA</td>
<td align="right">3</td>
<td align="right">3</td>
<td align="right">3</td>
<td align="right">3</td>
<td align="right">NA</td>
<td align="right">3</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">Physa</td>
<td align="right">1</td>
<td align="right">3</td>
<td align="right">3</td>
<td align="right">3</td>
<td align="right">3</td>
<td align="right">3</td>
<td align="right">3</td>
<td align="right">3</td>
<td align="right">3</td>
<td align="right">3</td>
<td align="right">3</td>
<td align="right">NA</td>
<td align="right">3</td>
<td align="right">3</td>
<td align="right">3</td>
<td align="right">3</td>
<td align="right">3</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">Zooplankton</td>
<td align="right">3</td>
<td align="right">3</td>
<td align="right">2</td>
<td align="right">3</td>
<td align="right">1</td>
<td align="right">3</td>
<td align="right">1</td>
<td align="right">3</td>
<td align="right">3</td>
<td align="right">3</td>
<td align="right">2</td>
<td align="right">3</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">3</td>
<td align="right">3</td>
<td align="right">3</td>
<td align="right">3</td>
</tr>
</tbody>
</table>
<div class="section level3">
<h3 id="trophic-position">1- Trophic position<a class="anchor" aria-label="anchor" href="#trophic-position"></a>
</h3>
<p>Standardized D15N values are called “trophic position” (TP). We
standardize N values using strict primary consumers: clams and Physa. We
calculate the average D15N of the primary consumers and add it to the
dataset.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">MeanBaselineN</span> <span class="op">&lt;-</span> <span class="va">Dataset</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Taxa</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Corbiculidae"</span>, <span class="st">"Physa"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">Pond</span>, <span class="va">Taxa</span><span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>meanD15N <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">D15N_Mu</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">Pond</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>meanD15N <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">meanD15N</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add mean baseline to each individual of Dataset</span></span>
<span><span class="va">Dataset</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">Dataset</span>, <span class="va">MeanBaselineN</span>, by <span class="op">=</span> <span class="st">"Pond"</span>, all <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></code></pre></div>
<p>Verify that we still have the correct number of rows in the table</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">Dataset</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">==</span> <span class="fl">1306</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] TRUE</span></span></code></pre>
<p>Based on this baseline of primary consumers, we calculate the trophic
position (TP) as<br><span class="math inline">\(TP = 2 + D15N_{sample} - D15N_{baseline} /
delta\)</span> Delta is the fractionation coefficient and here delta =
3.4</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Delta</span> <span class="op">=</span> <span class="fl">3.4</span></span>
<span><span class="va">Dataset</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/compound.html" class="external-link">%&lt;&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>TP <span class="op">=</span> <span class="fl">2</span><span class="op">+</span><span class="op">(</span><span class="va">Dataset</span><span class="op">$</span><span class="va">D15N_Mu</span><span class="op">-</span><span class="va">Dataset</span><span class="op">$</span><span class="va">meanD15N</span><span class="op">)</span><span class="op">/</span><span class="va">Delta</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="carbon-correction">2- Carbon correction<a class="anchor" aria-label="anchor" href="#carbon-correction"></a>
</h3>
<p>We need taxa to serve as markers of the variability in carbon
resources in each pond, to standardize the C isotopic value of samples
into a variable called “Delta 13C corrected”. Taxa used are: clams,
physa, zooplankton, gammarus, corixidae and asellus. We compute the mean
of their averaged values (<span class="math inline">\(D^{13}C_{meanC1}\)</span>), then correct
individual carbon values (i) using the equation:<br><span class="math inline">\(D^{13}C_{cor} = (D^{13}C_{i} -
D^{13}C_{meanC1}) / range D^{13}C_{C1}\)</span></p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">BaselineC</span> <span class="op">&lt;-</span> <span class="va">Dataset</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Taxa</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Corbiculidae"</span>, <span class="st">"Physa"</span>, <span class="st">"Zooplankton"</span>, <span class="st">"Gammarus"</span>, </span>
<span>                     <span class="st">"Corixidae"</span>, <span class="st">"Asellus"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">Pond</span>, <span class="va">Taxa</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>meanD13C <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">D13C_LFMu</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">Pond</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>meanavD13C <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">meanD13C</span><span class="op">)</span>,</span>
<span>            maxavD13C <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">meanD13C</span><span class="op">)</span>,</span>
<span>            minavD13C <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">meanD13C</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Add mean baseline to each individual of Dataset</span></span>
<span><span class="va">Dataset</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">Dataset</span>, <span class="va">BaselineC</span>, by <span class="op">=</span> <span class="st">"Pond"</span>, all <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Calcul Ccor</span></span>
<span><span class="va">Dataset</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/compound.html" class="external-link">%&lt;&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>D13Ccor_consoI <span class="op">=</span> <span class="op">(</span><span class="va">D13C_LFMu</span> <span class="op">-</span> <span class="va">meanavD13C</span><span class="op">)</span> <span class="op">/</span> </span>
<span>                      <span class="op">(</span><span class="va">maxavD13C</span> <span class="op">-</span> <span class="va">minavD13C</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>We now have standardized isotope values!</p>
</div>
</div>
<div class="section level2">
<h2 id="c--export-dataset">C- Export dataset<a class="anchor" aria-label="anchor" href="#c--export-dataset"></a>
</h2>
<p>Verify that we still have the correct number of rows and keep only
the taxa of interest for the next steps.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">Dataset</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">==</span> <span class="fl">1306</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] TRUE</span></span></code></pre>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Dataset</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/compound.html" class="external-link">%&lt;&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Group</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Amphibians"</span>, <span class="st">"Crayfish"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Export the dataset</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create a folder if it does not exist</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.exists</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span>,<span class="st">"exported_data"</span><span class="op">)</span><span class="op">)</span> <span class="op">==</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.create</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span>,<span class="st">"exported_data"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.csv</a></span><span class="op">(</span><span class="va">Dataset</span>, <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"exported_data"</span>, </span>
<span>                             <span class="st">"Isotope_data_standardized.csv"</span><span class="op">)</span>, row.names <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span></code></pre></div>
<p>In the next vignettes, we will install the package siar, then compute
the niche metrics necessary for the analysis of the stable isotope
niches.</p>
</div>
<div class="footnotes footnotes-end-of-document">
<hr>
<ol>
<li id="fn1"><p>UMR EcoBio, UMR DECOD <a href="mailto:nadege.belouard@gmail.com" class="email">nadege.belouard@gmail.com</a><a href="#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Nadège Belouard.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
