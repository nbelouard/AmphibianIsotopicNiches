<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>#4: Compute statistical models • AmphibianIsotopicNiches</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="#4: Compute statistical models">
<meta property="og:description" content="AmphibianIsotopicNiches">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">AmphibianIsotopicNiches</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/010_Isotope_data_standardization.html">#1: Isotope data standardization</a>
    </li>
    <li>
      <a href="../articles/029_Install_siar_from_archive.html">Install siar from archive</a>
    </li>
    <li>
      <a href="../articles/030_Isotope_metrics.html">#2: Compute niche metrics</a>
    </li>
    <li>
      <a href="../articles/040_Trophic_networks_plots_ellipses.html">#3: Plots stable isotope niches with ellipses</a>
    </li>
    <li>
      <a href="../articles/060_Statistical_models_isotopes.html">#4: Compute statistical models</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>#4: Compute statistical models</h1>
                        <h4 data-toc-skip class="author">Nadege
Belouard<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>
</h4>
            
            <h4 data-toc-skip class="date">03/06/2024</h4>
      
      
      <div class="hidden name"><code>060_Statistical_models_isotopes.Rmd</code></div>

    </div>

    
    
<p>This vignette tests the link between the isotopic niche metrics of
amphibians and candidate variables, including crayfish.</p>
<div class="section level2">
<h2 id="setup">1. Setup<a class="anchor" aria-label="anchor" href="#setup"></a>
</h2>
<p>We begin by loading the required libraries and datasets.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Load packages</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/lme4/lme4/" class="external-link">lme4</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Loading required package: Matrix</span></span></code></pre>
<pre><code><span><span class="co">## Warning: package 'Matrix' was built under R version 4.3.3</span></span></code></pre>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-forge.r-project.org/projects/car/" class="external-link">car</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Loading required package: carData</span></span></code></pre>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">MuMIn</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: package 'ggplot2' was built under R version 4.3.3</span></span></code></pre>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">RVAideMemoire</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: package 'RVAideMemoire' was built under R version 4.3.3</span></span></code></pre>
<pre><code><span><span class="co">## *** Package RVAideMemoire v 0.9-83-7 ***</span></span></code></pre>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Attaching package: 'RVAideMemoire'</span></span></code></pre>
<pre><code><span><span class="co">## The following object is masked from 'package:lme4':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     dummy</span></span></code></pre>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggrepel.slowkow.com/" class="external-link">ggrepel</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: package 'ggrepel' was built under R version 4.3.3</span></span></code></pre>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org" class="external-link">magrittr</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Attaching package: 'magrittr'</span></span></code></pre>
<pre><code><span><span class="co">## The following object is masked from 'package:RVAideMemoire':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     mod</span></span></code></pre>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://hbiostat.org/R/Hmisc/" class="external-link">Hmisc</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: package 'Hmisc' was built under R version 4.3.3</span></span></code></pre>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Attaching package: 'Hmisc'</span></span></code></pre>
<pre><code><span><span class="co">## The following objects are masked from 'package:base':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     format.pval, units</span></span></code></pre>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-gis.net/" class="external-link">usdm</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: package 'usdm' was built under R version 4.3.3</span></span></code></pre>
<pre><code><span><span class="co">## Loading required package: terra</span></span></code></pre>
<pre><code><span><span class="co">## Warning: package 'terra' was built under R version 4.3.3</span></span></code></pre>
<pre><code><span><span class="co">## terra 1.7.71</span></span></code></pre>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Attaching package: 'terra'</span></span></code></pre>
<pre><code><span><span class="co">## The following objects are masked from 'package:Hmisc':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     describe, mask, zoom</span></span></code></pre>
<pre><code><span><span class="co">## The following objects are masked from 'package:magrittr':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     extract, inset</span></span></code></pre>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Attaching package: 'usdm'</span></span></code></pre>
<pre><code><span><span class="co">## The following object is masked from 'package:car':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     vif</span></span></code></pre>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: package 'tidyr' was built under R version 4.3.3</span></span></code></pre>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Attaching package: 'tidyr'</span></span></code></pre>
<pre><code><span><span class="co">## The following object is masked from 'package:terra':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     extract</span></span></code></pre>
<pre><code><span><span class="co">## The following object is masked from 'package:magrittr':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     extract</span></span></code></pre>
<pre><code><span><span class="co">## The following objects are masked from 'package:Matrix':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     expand, pack, unpack</span></span></code></pre>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: package 'dplyr' was built under R version 4.3.3</span></span></code></pre>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Attaching package: 'dplyr'</span></span></code></pre>
<pre><code><span><span class="co">## The following objects are masked from 'package:terra':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     intersect, union</span></span></code></pre>
<pre><code><span><span class="co">## The following objects are masked from 'package:Hmisc':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     src, summarize</span></span></code></pre>
<pre><code><span><span class="co">## The following object is masked from 'package:car':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     recode</span></span></code></pre>
<pre><code><span><span class="co">## The following objects are masked from 'package:stats':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     filter, lag</span></span></code></pre>
<pre><code><span><span class="co">## The following objects are masked from 'package:base':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     intersect, setdiff, setequal, union</span></span></code></pre>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tibble.tidyverse.org/" class="external-link">tibble</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">gridExtra</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Attaching package: 'gridExtra'</span></span></code></pre>
<pre><code><span><span class="co">## The following object is masked from 'package:dplyr':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     combine</span></span></code></pre>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://here.r-lib.org/" class="external-link">here</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## here() starts at C:/Users/robin/Documents/Nadege/ATER/Recherche/Projets terminés/Trophic networks/coexistence-isoniches</span></span></code></pre>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://wilkelab.org/cowplot/" class="external-link">cowplot</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: package 'cowplot' was built under R version 4.3.3</span></span></code></pre>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://easystats.github.io/performance/" class="external-link">performance</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: package 'performance' was built under R version 4.3.3</span></span></code></pre>
<p>Then we load the datasets: environmental variables, population
metrics and mean position.</p>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Load datasets</span></span>
<span><span class="va">Envt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">"data_raw"</span>, <span class="st">"Raw_environment.csv"</span><span class="op">)</span>, h <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="va">Envt</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/compound.html" class="external-link">%&lt;&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Crayfish01 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">CrayfishCPUE</span> <span class="op">==</span> <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span>         </span>
<span><span class="co"># Dataset</span></span>
<span><span class="va">Niche_metrics</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"exported_data"</span>, </span>
<span>                                    <span class="st">"Population_metrics.csv"</span><span class="op">)</span>, h <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">Code</span>, <span class="va">Pond</span>, <span class="va">Species</span>, <span class="va">SEAc</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Mean_position</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"exported_data"</span>, </span>
<span>                                    <span class="st">"Meanposition_SEAc.csv"</span><span class="op">)</span>, header <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">Mean_position</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"Code"</span></span></code></pre></div>
<p>We merge the different datasets and create a “Group” column (newts or
tadpoles). We also create a dataset that keeps only amphibian
populations for analysis of the variation in niche metrics.</p>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Pop_metrics</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">Niche_metrics</span>, <span class="va">Mean_position</span>, </span>
<span>                     by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Pond"</span>, <span class="st">"Code"</span>, <span class="st">"Species"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">Pop_metrics</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">Niche_metrics</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] TRUE</span></span></code></pre>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">Pop_metrics</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">Mean_position</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] TRUE</span></span></code></pre>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">Pop_metrics</span><span class="op">$</span><span class="va">Pond</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">Pop_metrics</span><span class="op">$</span><span class="va">Species</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op"><a href="https://rspatial.github.io/terra/reference/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Agile frog"</span>, <span class="st">"Tree frog"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">Pop_metrics</span><span class="op">$</span><span class="va">Group</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="st">"Tadpoles"</span></span>
<span>    <span class="va">Pop_metrics</span><span class="op">$</span><span class="va">Clade</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="st">"Amphibians"</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">Pop_metrics</span><span class="op">$</span><span class="va">Species</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op"><a href="https://rspatial.github.io/terra/reference/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Palmate newt"</span>, <span class="st">"Marbled newt"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">Pop_metrics</span><span class="op">$</span><span class="va">Group</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="st">"Newts"</span></span>
<span>    <span class="va">Pop_metrics</span><span class="op">$</span><span class="va">Clade</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="st">"Amphibians"</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="va">Pop_metrics</span><span class="op">$</span><span class="va">Group</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="st">"Crayfish"</span></span>
<span>    <span class="va">Pop_metrics</span><span class="op">$</span><span class="va">Clade</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="st">"Crayfish"</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co">#Create a dataset only for amphibian populations</span></span>
<span><span class="va">Pop_amphib</span> <span class="op">&lt;-</span> <span class="va">Pop_metrics</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Clade</span> <span class="op">==</span> <span class="st">"Amphibians"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Merge metrics and explicative variables</span></span>
<span><span class="va">Pop_dataset</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">Pop_amphib</span>, <span class="va">Envt</span>, by <span class="op">=</span> <span class="st">"Pond"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"Are there still 41 populations in the dataset?"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "Are there still 41 populations in the dataset?"</span></span></code></pre>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">Pop_dataset</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">==</span> <span class="fl">41</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] TRUE</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="models-variation-in-amphibian-niche-metrics">2. Models: variation in amphibian niche metrics<a class="anchor" aria-label="anchor" href="#models-variation-in-amphibian-niche-metrics"></a>
</h2>
<p>For each metric tested, we (1) check GOF of a simple model, and
transform the metric if necessary, (2) run the model selection and (3)
plot the figure corresponding to the selected models.</p>
<div class="section level4">
<h4 id="seac">SEAc<a class="anchor" aria-label="anchor" href="#seac"></a>
</h4>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Test species as a random factor</span></span>
<span><span class="va">mod1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html" class="external-link">lmer</a></span><span class="op">(</span><span class="va">SEAc</span> <span class="op">~</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">Canopycover</span><span class="op">)</span><span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">Species</span><span class="op">)</span>, </span>
<span>             na.action <span class="op">=</span> <span class="st">"na.fail"</span>, data <span class="op">=</span> <span class="va">Pop_dataset</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## boundary (singular) fit: see help('isSingular')</span></span></code></pre>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/RVAideMemoire/man/plotresid.html" class="external-link">plotresid</a></span><span class="op">(</span><span class="va">mod1</span><span class="op">)</span></span></code></pre></div>
<p><img src="060_Statistical_models_isotopes_files/figure-html/check%20GOF%20for%20SEAc-1.png" width="700"></p>
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Linear mixed model fit by REML ['lmerMod']</span></span>
<span><span class="co">## Formula: SEAc ~ scale(Canopycover) + (1 | Species)</span></span>
<span><span class="co">##    Data: Pop_dataset</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## REML criterion at convergence: -111.3</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Scaled residuals: </span></span>
<span><span class="co">##     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">## -1.2613 -0.7209 -0.1306  0.4587  2.9104 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Random effects:</span></span>
<span><span class="co">##  Groups   Name        Variance Std.Dev.</span></span>
<span><span class="co">##  Species  (Intercept) 0.000000 0.00000 </span></span>
<span><span class="co">##  Residual             0.002794 0.05285 </span></span>
<span><span class="co">## Number of obs: 41, groups:  Species, 4</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Fixed effects:</span></span>
<span><span class="co">##                     Estimate Std. Error t value</span></span>
<span><span class="co">## (Intercept)         0.059572   0.008254   7.217</span></span>
<span><span class="co">## scale(Canopycover) -0.030790   0.008357  -3.684</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Correlation of Fixed Effects:</span></span>
<span><span class="co">##             (Intr)</span></span>
<span><span class="co">## scl(Cnpycv) 0.000 </span></span>
<span><span class="co">## optimizer (nloptwrap) convergence code: 0 (OK)</span></span>
<span><span class="co">## boundary (singular) fit: see help('isSingular')</span></span></code></pre>
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># No variance in "species", we remove it</span></span>
<span></span>
<span><span class="co"># Test pond as a random factor</span></span>
<span><span class="va">mod1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html" class="external-link">lmer</a></span><span class="op">(</span><span class="va">SEAc</span> <span class="op">~</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">Canopycover</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">Pond</span><span class="op">)</span>, </span>
<span>             na.action <span class="op">=</span> <span class="st">"na.fail"</span>, data <span class="op">=</span> <span class="va">Pop_dataset</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/RVAideMemoire/man/plotresid.html" class="external-link">plotresid</a></span><span class="op">(</span><span class="va">mod1</span><span class="op">)</span></span></code></pre></div>
<p><img src="060_Statistical_models_isotopes_files/figure-html/check%20GOF%20for%20SEAc-2.png" width="700"></p>
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Linear mixed model fit by REML ['lmerMod']</span></span>
<span><span class="co">## Formula: SEAc ~ scale(Canopycover) + (1 | Pond)</span></span>
<span><span class="co">##    Data: Pop_dataset</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## REML criterion at convergence: -116.3</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Scaled residuals: </span></span>
<span><span class="co">##     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">## -1.4669 -0.5611 -0.1386  0.2157  2.6714 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Random effects:</span></span>
<span><span class="co">##  Groups   Name        Variance  Std.Dev.</span></span>
<span><span class="co">##  Pond     (Intercept) 0.0009733 0.03120 </span></span>
<span><span class="co">##  Residual             0.0018522 0.04304 </span></span>
<span><span class="co">## Number of obs: 41, groups:  Pond, 15</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Fixed effects:</span></span>
<span><span class="co">##                    Estimate Std. Error t value</span></span>
<span><span class="co">## (Intercept)         0.05601    0.01078   5.196</span></span>
<span><span class="co">## scale(Canopycover) -0.02936    0.01113  -2.638</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Correlation of Fixed Effects:</span></span>
<span><span class="co">##             (Intr)</span></span>
<span><span class="co">## scl(Cnpycv) -0.060</span></span></code></pre>
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Residuals are not normal, try log-transforming the variable</span></span>
<span></span>
<span><span class="va">mod1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html" class="external-link">lmer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">SEAc</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">Canopycover</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">Pond</span><span class="op">)</span>, </span>
<span>             na.action <span class="op">=</span> <span class="st">"na.fail"</span>, data <span class="op">=</span> <span class="va">Pop_dataset</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/RVAideMemoire/man/plotresid.html" class="external-link">plotresid</a></span><span class="op">(</span><span class="va">mod1</span><span class="op">)</span></span></code></pre></div>
<p><img src="060_Statistical_models_isotopes_files/figure-html/check%20GOF%20for%20SEAc-3.png" width="700"></p>
<div class="sourceCode" id="cb73"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Linear mixed model fit by REML ['lmerMod']</span></span>
<span><span class="co">## Formula: log(SEAc) ~ scale(Canopycover) + (1 | Pond)</span></span>
<span><span class="co">##    Data: Pop_dataset</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## REML criterion at convergence: 92.5</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Scaled residuals: </span></span>
<span><span class="co">##      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">## -2.27448 -0.42456 -0.04156  0.51172  2.25149 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Random effects:</span></span>
<span><span class="co">##  Groups   Name        Variance Std.Dev.</span></span>
<span><span class="co">##  Pond     (Intercept) 0.2706   0.5202  </span></span>
<span><span class="co">##  Residual             0.3665   0.6054  </span></span>
<span><span class="co">## Number of obs: 41, groups:  Pond, 15</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Fixed effects:</span></span>
<span><span class="co">##                    Estimate Std. Error t value</span></span>
<span><span class="co">## (Intercept)         -3.3045     0.1687 -19.586</span></span>
<span><span class="co">## scale(Canopycover)  -0.4317     0.1745  -2.473</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Correlation of Fixed Effects:</span></span>
<span><span class="co">##             (Intr)</span></span>
<span><span class="co">## scl(Cnpycv) -0.070</span></span></code></pre>
<div class="sourceCode" id="cb75"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Everything looks okay</span></span></code></pre></div>
<p>We go with the transformed SEAc and pond as a random factor.</p>
<div class="sourceCode" id="cb76"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## If you want to test the same models, without tree frog tadpoles, uncomment this line</span></span>
<span><span class="co"># Pop_dataset %&lt;&gt;% filter(Species != "Tree frog")</span></span>
<span><span class="co"># dim(Pop_dataset) # 32</span></span>
<span></span>
<span><span class="co"># Run the most complex model</span></span>
<span><span class="va">mod_SEA</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html" class="external-link">lmer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">SEAc</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">Area</span><span class="op">)</span> <span class="op">+</span> </span>
<span>                  <span class="fu"><a href="https://rspatial.github.io/terra/reference/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">Canopycover</span><span class="op">)</span> <span class="op">+</span> </span>
<span>                  <span class="fu"><a href="https://rspatial.github.io/terra/reference/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">Aq_VegCover</span><span class="op">)</span> <span class="op">+</span></span>
<span>                  <span class="fu"><a href="https://rspatial.github.io/terra/reference/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">CrayfishCPUE</span><span class="op">)</span> <span class="op">+</span></span>
<span>                <span class="fu"><a href="https://rspatial.github.io/terra/reference/is.bool.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">Crayfish01</span><span class="op">)</span> <span class="op">+</span></span>
<span>                  <span class="fu"><a href="https://rspatial.github.io/terra/reference/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">Agile_frog</span><span class="op">)</span> <span class="op">+</span> </span>
<span>                  <span class="fu"><a href="https://rspatial.github.io/terra/reference/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">Tree_frog</span><span class="op">)</span> <span class="op">+</span> </span>
<span>                  <span class="fu"><a href="https://rspatial.github.io/terra/reference/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">Palmate_newt</span><span class="op">)</span> <span class="op">+</span> </span>
<span>                  <span class="fu"><a href="https://rspatial.github.io/terra/reference/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">Marbled_newtCPUE</span><span class="op">)</span> <span class="op">+</span></span>
<span>                  <span class="va">Group</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">Pond</span><span class="op">)</span>,</span>
<span>                na.action <span class="op">=</span> <span class="st">"na.fail"</span>, </span>
<span>                data <span class="op">=</span> <span class="va">Pop_dataset</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## boundary (singular) fit: see help('isSingular')</span></span></code></pre>
<div class="sourceCode" id="cb78"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Dredge all the combinations of 0 to 2 candidate variables</span></span>
<span><span class="va">SEA_dredge</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MuMIn/man/dredge.html" class="external-link">dredge</a></span><span class="op">(</span><span class="va">mod_SEA</span>,</span>
<span>                     rank <span class="op">=</span> <span class="va">AICc</span>, m.lim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2</span><span class="op">)</span>, extra<span class="op">=</span><span class="st">"R^2"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in dredge(mod_SEA, rank = AICc, m.lim = c(0, 2), extra = "R^2"):</span></span>
<span><span class="co">## comparing models fitted by REML</span></span></code></pre>
<pre><code><span><span class="co">## Fixed term is "(Intercept)"</span></span></code></pre>
<div class="sourceCode" id="cb81"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Select models within delta &lt; 2</span></span>
<span><span class="va">SEA_select</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">SEA_dredge</span>, <span class="va">delta</span> <span class="op">&lt;</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Show selection</span></span>
<span><span class="va">SEA_select</span></span></code></pre></div>
<pre><code><span><span class="co">## Global model call: lmer(formula = log(SEAc) ~ scale(Area) + scale(Canopycover) + </span></span>
<span><span class="co">##     scale(Aq_VegCover) + scale(CrayfishCPUE) + as.factor(Crayfish01) + </span></span>
<span><span class="co">##     scale(Agile_frog) + scale(Tree_frog) + scale(Palmate_newt) + </span></span>
<span><span class="co">##     scale(Marbled_newtCPUE) + Group + (1 | Pond), data = Pop_dataset, </span></span>
<span><span class="co">##     na.action = "na.fail")</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Model selection table </span></span>
<span><span class="co">##      (Int) scl(Agl_frg) scl(Mrb_nCP)    R^2 df  logLik AICc delta weight</span></span>
<span><span class="co">## 133 -3.228       -0.338       0.6104 0.5337  5 -40.937 93.6  0.00  0.704</span></span>
<span><span class="co">## 129 -3.223                    0.5587 0.4337  4 -43.106 95.3  1.74  0.296</span></span>
<span><span class="co">## Models ranked by AICc(x) </span></span>
<span><span class="co">## Random terms (all models): </span></span>
<span><span class="co">##   1 | Pond</span></span></code></pre>
<p>Two models are retained for SEAc. They contain the variables agile
frog and marbled newt.</p>
<p>We check the content of these model as well as the first model
containing either Crayfish abundance or Crayfish presence, and the null
model.</p>
<div class="sourceCode" id="cb83"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Show the model syntax</span></span>
<span><span class="va">SEA_dredge</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MuMIn/man/dredge.html" class="external-link">dredge</a></span><span class="op">(</span><span class="va">mod_SEA</span>, rank <span class="op">=</span> <span class="va">AICc</span>, </span>
<span>                     m.lim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">2</span><span class="op">)</span>, extra<span class="op">=</span><span class="st">"R^2"</span>, evaluate<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in dredge(mod_SEA, rank = AICc, m.lim = c(0, 2), extra = "R^2", :</span></span>
<span><span class="co">## comparing models fitted by REML</span></span></code></pre>
<pre><code><span><span class="co">## Fixed term is "(Intercept)"</span></span></code></pre>
<div class="sourceCode" id="cb86"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">SEA_dredge</span><span class="op">$</span><span class="st">'133'</span></span></code></pre></div>
<pre><code><span><span class="co">## lmer(formula = log(SEAc) ~ scale(Agile_frog) + scale(Marbled_newtCPUE) + </span></span>
<span><span class="co">##     (1 | Pond), data = Pop_dataset, na.action = "na.fail")</span></span></code></pre>
<div class="sourceCode" id="cb88"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">SEA_dredge</span><span class="op">$</span><span class="st">'129'</span></span></code></pre></div>
<pre><code><span><span class="co">## lmer(formula = log(SEAc) ~ scale(Marbled_newtCPUE) + (1 | Pond), </span></span>
<span><span class="co">##     data = Pop_dataset, na.action = "na.fail")</span></span></code></pre>
<div class="sourceCode" id="cb90"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># First model</span></span>
<span><span class="va">SEA_dredge</span><span class="op">$</span><span class="st">'133'</span></span></code></pre></div>
<pre><code><span><span class="co">## lmer(formula = log(SEAc) ~ scale(Agile_frog) + scale(Marbled_newtCPUE) + </span></span>
<span><span class="co">##     (1 | Pond), data = Pop_dataset, na.action = "na.fail")</span></span></code></pre>
<div class="sourceCode" id="cb92"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Model_selected1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html" class="external-link">lmer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">SEAc</span><span class="op">)</span> <span class="op">~</span> </span>
<span>                          <span class="fu"><a href="https://rspatial.github.io/terra/reference/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">Agile_frog</span><span class="op">)</span> <span class="op">+</span></span>
<span>                          <span class="fu"><a href="https://rspatial.github.io/terra/reference/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">Marbled_newtCPUE</span><span class="op">)</span></span>
<span>                        <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">Pond</span><span class="op">)</span>,</span>
<span>             na.action<span class="op">=</span><span class="st">"na.fail"</span>, data <span class="op">=</span> <span class="va">Pop_dataset</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/RVAideMemoire/man/plotresid.html" class="external-link">plotresid</a></span><span class="op">(</span><span class="va">Model_selected1</span><span class="op">)</span></span></code></pre></div>
<p><img src="060_Statistical_models_isotopes_files/figure-html/check%20the%20content%20of%20each%20model%20for%20SEAc-1.png" width="700"></p>
<div class="sourceCode" id="cb93"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">Model_selected1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Linear mixed model fit by REML ['lmerMod']</span></span>
<span><span class="co">## Formula: log(SEAc) ~ scale(Agile_frog) + scale(Marbled_newtCPUE) + (1 |  </span></span>
<span><span class="co">##     Pond)</span></span>
<span><span class="co">##    Data: Pop_dataset</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## REML criterion at convergence: 81.9</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Scaled residuals: </span></span>
<span><span class="co">##      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">## -2.75597 -0.54113 -0.04586  0.50403  2.12486 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Random effects:</span></span>
<span><span class="co">##  Groups   Name        Variance Std.Dev.</span></span>
<span><span class="co">##  Pond     (Intercept) 0.03361  0.1833  </span></span>
<span><span class="co">##  Residual             0.35231  0.5936  </span></span>
<span><span class="co">## Number of obs: 41, groups:  Pond, 15</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Fixed effects:</span></span>
<span><span class="co">##                         Estimate Std. Error t value</span></span>
<span><span class="co">## (Intercept)              -3.2284     0.1058 -30.517</span></span>
<span><span class="co">## scale(Agile_frog)        -0.3380     0.1108  -3.051</span></span>
<span><span class="co">## scale(Marbled_newtCPUE)   0.6104     0.1075   5.679</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Correlation of Fixed Effects:</span></span>
<span><span class="co">##             (Intr) sc(A_)</span></span>
<span><span class="co">## scl(Agl_fr)  0.010       </span></span>
<span><span class="co">## scl(M_CPUE)  0.054 -0.172</span></span></code></pre>
<div class="sourceCode" id="cb95"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">Model_selected1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/math-generics.html" class="external-link">round</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">coefficients</span>,<span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                         Estimate Std. Error t value</span></span>
<span><span class="co">## (Intercept)                -3.23       0.11  -30.52</span></span>
<span><span class="co">## scale(Agile_frog)          -0.34       0.11   -3.05</span></span>
<span><span class="co">## scale(Marbled_newtCPUE)     0.61       0.11    5.68</span></span></code></pre>
<div class="sourceCode" id="cb97"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/car/man/Anova.html" class="external-link">Anova</a></span><span class="op">(</span><span class="va">Model_selected1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Analysis of Deviance Table (Type II Wald chisquare tests)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Response: log(SEAc)</span></span>
<span><span class="co">##                           Chisq Df Pr(&gt;Chisq)    </span></span>
<span><span class="co">## scale(Agile_frog)        9.3093  1    0.00228 ** </span></span>
<span><span class="co">## scale(Marbled_newtCPUE) 32.2533  1  1.353e-08 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre>
<div class="sourceCode" id="cb99"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">performance</span><span class="fu">::</span><span class="fu"><a href="https://easystats.github.io/performance/reference/r2_nakagawa.html" class="external-link">r2_nakagawa</a></span><span class="op">(</span><span class="va">Model_selected1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## # R2 for Mixed Models</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   Conditional R2: 0.561</span></span>
<span><span class="co">##      Marginal R2: 0.519</span></span></code></pre>
<div class="sourceCode" id="cb101"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Second model</span></span>
<span><span class="va">SEA_dredge</span><span class="op">$</span><span class="st">'129'</span></span></code></pre></div>
<pre><code><span><span class="co">## lmer(formula = log(SEAc) ~ scale(Marbled_newtCPUE) + (1 | Pond), </span></span>
<span><span class="co">##     data = Pop_dataset, na.action = "na.fail")</span></span></code></pre>
<div class="sourceCode" id="cb103"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Model_selected2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html" class="external-link">lmer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">SEAc</span><span class="op">)</span> <span class="op">~</span> </span>
<span>                          <span class="fu"><a href="https://rspatial.github.io/terra/reference/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">Marbled_newtCPUE</span><span class="op">)</span></span>
<span>                        <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">Pond</span><span class="op">)</span>,</span>
<span>             na.action<span class="op">=</span><span class="st">"na.fail"</span>, data <span class="op">=</span> <span class="va">Pop_dataset</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/RVAideMemoire/man/plotresid.html" class="external-link">plotresid</a></span><span class="op">(</span><span class="va">Model_selected2</span><span class="op">)</span></span></code></pre></div>
<p><img src="060_Statistical_models_isotopes_files/figure-html/check%20the%20content%20of%20each%20model%20for%20SEAc-2.png" width="700"></p>
<div class="sourceCode" id="cb104"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">Model_selected2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Linear mixed model fit by REML ['lmerMod']</span></span>
<span><span class="co">## Formula: log(SEAc) ~ scale(Marbled_newtCPUE) + (1 | Pond)</span></span>
<span><span class="co">##    Data: Pop_dataset</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## REML criterion at convergence: 86.2</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Scaled residuals: </span></span>
<span><span class="co">##     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">## -2.4055 -0.5786  0.0443  0.5048  2.2220 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Random effects:</span></span>
<span><span class="co">##  Groups   Name        Variance Std.Dev.</span></span>
<span><span class="co">##  Pond     (Intercept) 0.1367   0.3698  </span></span>
<span><span class="co">##  Residual             0.3506   0.5921  </span></span>
<span><span class="co">## Number of obs: 41, groups:  Pond, 15</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Fixed effects:</span></span>
<span><span class="co">##                         Estimate Std. Error t value</span></span>
<span><span class="co">## (Intercept)              -3.2229     0.1378 -23.397</span></span>
<span><span class="co">## scale(Marbled_newtCPUE)   0.5587     0.1352   4.132</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Correlation of Fixed Effects:</span></span>
<span><span class="co">##             (Intr)</span></span>
<span><span class="co">## scl(M_CPUE) 0.145</span></span></code></pre>
<div class="sourceCode" id="cb106"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">Model_selected2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/math-generics.html" class="external-link">round</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">coefficients</span>,<span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                         Estimate Std. Error t value</span></span>
<span><span class="co">## (Intercept)                -3.22       0.14  -23.40</span></span>
<span><span class="co">## scale(Marbled_newtCPUE)     0.56       0.14    4.13</span></span></code></pre>
<div class="sourceCode" id="cb108"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/car/man/Anova.html" class="external-link">Anova</a></span><span class="op">(</span><span class="va">Model_selected2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Analysis of Deviance Table (Type II Wald chisquare tests)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Response: log(SEAc)</span></span>
<span><span class="co">##                          Chisq Df Pr(&gt;Chisq)    </span></span>
<span><span class="co">## scale(Marbled_newtCPUE) 17.072  1  3.599e-05 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre>
<div class="sourceCode" id="cb110"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">performance</span><span class="fu">::</span><span class="fu"><a href="https://easystats.github.io/performance/reference/r2_nakagawa.html" class="external-link">r2_nakagawa</a></span><span class="op">(</span><span class="va">Model_selected2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## # R2 for Mixed Models</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   Conditional R2: 0.561</span></span>
<span><span class="co">##      Marginal R2: 0.390</span></span></code></pre>
<div class="sourceCode" id="cb112"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># First model with crayfish abundance</span></span>
<span><span class="va">Model_CCPUE</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html" class="external-link">lmer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">SEAc</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">Canopycover</span><span class="op">)</span> <span class="op">+</span></span>
<span>                          <span class="fu"><a href="https://rspatial.github.io/terra/reference/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">CrayfishCPUE</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">Pond</span><span class="op">)</span>,</span>
<span>             na.action <span class="op">=</span> <span class="st">"na.fail"</span>, data <span class="op">=</span> <span class="va">Pop_dataset</span><span class="op">)</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">Model_CCPUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/math-generics.html" class="external-link">round</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">coefficients</span>,<span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                     Estimate Std. Error t value</span></span>
<span><span class="co">## (Intercept)            -3.23       0.14  -22.93</span></span>
<span><span class="co">## scale(Canopycover)     -0.35       0.15   -2.40</span></span>
<span><span class="co">## scale(CrayfishCPUE)    -0.38       0.13   -2.82</span></span></code></pre>
<div class="sourceCode" id="cb114"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/car/man/Anova.html" class="external-link">Anova</a></span><span class="op">(</span><span class="va">Model_CCPUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Analysis of Deviance Table (Type II Wald chisquare tests)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Response: log(SEAc)</span></span>
<span><span class="co">##                      Chisq Df Pr(&gt;Chisq)   </span></span>
<span><span class="co">## scale(Canopycover)  5.7517  1   0.016473 * </span></span>
<span><span class="co">## scale(CrayfishCPUE) 7.9439  1   0.004825 **</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre>
<div class="sourceCode" id="cb116"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">performance</span><span class="fu">::</span><span class="fu"><a href="https://easystats.github.io/performance/reference/r2_nakagawa.html" class="external-link">r2_nakagawa</a></span><span class="op">(</span><span class="va">Model_CCPUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## # R2 for Mixed Models</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   Conditional R2: 0.567</span></span>
<span><span class="co">##      Marginal R2: 0.386</span></span></code></pre>
<div class="sourceCode" id="cb118"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#First model with crayfish presence</span></span>
<span><span class="va">Model_C01</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html" class="external-link">lmer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">SEAc</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">Agile_frog</span><span class="op">)</span> <span class="op">+</span></span>
<span>                          <span class="fu"><a href="https://rspatial.github.io/terra/reference/is.bool.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">Crayfish01</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">Pond</span><span class="op">)</span>,</span>
<span>             na.action<span class="op">=</span><span class="st">"na.fail"</span>, data <span class="op">=</span> <span class="va">Pop_dataset</span><span class="op">)</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">Model_C01</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/math-generics.html" class="external-link">round</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">coefficients</span>,<span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                        Estimate Std. Error t value</span></span>
<span><span class="co">## (Intercept)               -2.76       0.20  -14.09</span></span>
<span><span class="co">## scale(Agile_frog)         -0.34       0.15   -2.31</span></span>
<span><span class="co">## as.factor(Crayfish01)1    -1.10       0.28   -3.95</span></span></code></pre>
<div class="sourceCode" id="cb120"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/car/man/Anova.html" class="external-link">Anova</a></span><span class="op">(</span><span class="va">Model_C01</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Analysis of Deviance Table (Type II Wald chisquare tests)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Response: log(SEAc)</span></span>
<span><span class="co">##                         Chisq Df Pr(&gt;Chisq)    </span></span>
<span><span class="co">## scale(Agile_frog)      5.3516  1     0.0207 *  </span></span>
<span><span class="co">## as.factor(Crayfish01) 15.6052  1  7.804e-05 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre>
<div class="sourceCode" id="cb122"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">performance</span><span class="fu">::</span><span class="fu"><a href="https://easystats.github.io/performance/reference/r2_nakagawa.html" class="external-link">r2_nakagawa</a></span><span class="op">(</span><span class="va">Model_C01</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## # R2 for Mixed Models</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   Conditional R2: 0.571</span></span>
<span><span class="co">##      Marginal R2: 0.413</span></span></code></pre>
<div class="sourceCode" id="cb124"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Null model</span></span>
<span><span class="va">Model_null</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html" class="external-link">lmer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">SEAc</span><span class="op">)</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">Pond</span><span class="op">)</span>,</span>
<span>             na.action<span class="op">=</span><span class="st">"na.fail"</span>, data <span class="op">=</span> <span class="va">Pop_dataset</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">Model_null</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Linear mixed model fit by REML ['lmerMod']</span></span>
<span><span class="co">## Formula: log(SEAc) ~ 1 + (1 | Pond)</span></span>
<span><span class="co">##    Data: Pop_dataset</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## REML criterion at convergence: 96.2</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Scaled residuals: </span></span>
<span><span class="co">##      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">## -2.19525 -0.50568  0.03366  0.42474  2.31735 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Random effects:</span></span>
<span><span class="co">##  Groups   Name        Variance Std.Dev.</span></span>
<span><span class="co">##  Pond     (Intercept) 0.4198   0.6480  </span></span>
<span><span class="co">##  Residual             0.3687   0.6072  </span></span>
<span><span class="co">## Number of obs: 41, groups:  Pond, 15</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Fixed effects:</span></span>
<span><span class="co">##             Estimate Std. Error t value</span></span>
<span><span class="co">## (Intercept)  -3.3521     0.1965  -17.06</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="figure-with-seac">Figure with SEAc<a class="anchor" aria-label="anchor" href="#figure-with-seac"></a>
</h4>
<div class="sourceCode" id="cb126"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Organize factor levels</span></span>
<span><span class="va">Pop_dataset</span><span class="op">$</span><span class="va">Species</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">Pop_dataset</span><span class="op">$</span><span class="va">Species</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Crayfish"</span>,</span>
<span>                                                    <span class="st">"Agile frog"</span>,</span>
<span>                                                    <span class="st">"Tree frog"</span>,</span>
<span>                                                    <span class="st">"Palmate newt"</span>,</span>
<span>                                                    <span class="st">"Marbled newt"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Pop_dataset</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/compound.html" class="external-link">%&lt;&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Crayfish01 <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/recode.html" class="external-link">recode</a></span><span class="op">(</span><span class="va">Crayfish01</span>, </span>
<span>                                          <span class="st">"1"</span> <span class="op">=</span> <span class="st">"present"</span>,</span>
<span>                                          <span class="st">"0"</span> <span class="op">=</span> <span class="st">"absent"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Figure with marbled newt</span></span>
<span><span class="va">SEAc_marbre</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">Pop_dataset</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">SEAc</span><span class="op">)</span>, </span>
<span>                                       x <span class="op">=</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">Marbled_newtCPUE</span><span class="op">)</span></span>
<span>                                       <span class="co"># , group = Species</span></span>
<span>                                       <span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span>method<span class="op">=</span><span class="st">"lm"</span>,se<span class="op">=</span><span class="cn">F</span>, col <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col <span class="op">=</span> <span class="va">Species</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">2</span>, show.legend <span class="op">=</span> <span class="cn">F</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#0072B2"</span>, <span class="st">"#009E73"</span>, </span>
<span>                                <span class="st">"#56B4E9"</span>, <span class="st">"#CC79A7"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Marbled newt abundance, scaled"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"log(SEAc)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position<span class="op">=</span><span class="st">"none"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">SEAc_marbre</span></span></code></pre></div>
<pre><code><span><span class="co">## `geom_smooth()` using formula = 'y ~ x'</span></span></code></pre>
<p><img src="060_Statistical_models_isotopes_files/figure-html/corresponding%20figures%20for%20SEAc-1.png" width="700"></p>
<div class="sourceCode" id="cb128"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Figure with agile frog</span></span>
<span><span class="va">SEAc_agile</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">Pop_dataset</span>,</span>
<span>                     <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">SEAc</span><span class="op">)</span>,</span>
<span>                         x <span class="op">=</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">Agile_frog</span><span class="op">)</span></span>
<span>                         <span class="co"># , group = Species</span></span>
<span>                         <span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span>method<span class="op">=</span><span class="st">"lm"</span>,se<span class="op">=</span><span class="cn">F</span>, col <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col <span class="op">=</span> <span class="va">Species</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">2</span>, show.legend <span class="op">=</span> <span class="cn">F</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#0072B2"</span>, <span class="st">"#009E73"</span>, </span>
<span>                                <span class="st">"#56B4E9"</span>, <span class="st">"#CC79A7"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Agile frog density, scaled"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position<span class="op">=</span><span class="st">"none"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">SEAc_agile</span></span></code></pre></div>
<pre><code><span><span class="co">## `geom_smooth()` using formula = 'y ~ x'</span></span></code></pre>
<p><img src="060_Statistical_models_isotopes_files/figure-html/corresponding%20figures%20for%20SEAc-2.png" width="700"></p>
<div class="sourceCode" id="cb130"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Figure with crayfish presence</span></span>
<span><span class="va">SEAc_crayfish</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">Pop_dataset</span>, </span>
<span>             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">SEAc</span><span class="op">)</span>, </span>
<span>                 x <span class="op">=</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/is.bool.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">Crayfish01</span><span class="op">)</span></span>
<span>                 <span class="co"># , group = Species</span></span>
<span>                 <span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></span><span class="op">(</span>show.legend <span class="op">=</span> <span class="cn">F</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html" class="external-link">geom_jitter</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col <span class="op">=</span> <span class="va">Species</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#0072B2"</span>, <span class="st">"#009E73"</span>, </span>
<span>                                <span class="st">"#56B4E9"</span>, <span class="st">"#CC79A7"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Crayfish"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position<span class="op">=</span><span class="st">"none"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">SEAc_crayfish</span></span></code></pre></div>
<p><img src="060_Statistical_models_isotopes_files/figure-html/corresponding%20figures%20for%20SEAc-3.png" width="700"></p>
<div class="sourceCode" id="cb131"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Arrange the 3 figures on a row</span></span>
<span><span class="va">SEAc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">grid.arrange</a></span><span class="op">(</span><span class="va">SEAc_marbre</span>, <span class="va">SEAc_agile</span>, <span class="va">SEAc_crayfish</span>, ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## `geom_smooth()` using formula = 'y ~ x'</span></span>
<span><span class="co">## `geom_smooth()` using formula = 'y ~ x'</span></span></code></pre>
<p><img src="060_Statistical_models_isotopes_files/figure-html/corresponding%20figures%20for%20SEAc-4.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="mean-tp">Mean TP<a class="anchor" aria-label="anchor" href="#mean-tp"></a>
</h3>
<p>First check the model GOF</p>
<div class="sourceCode" id="cb133"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Check residuals</span></span>
<span><span class="va">mod1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html" class="external-link">lmer</a></span><span class="op">(</span><span class="va">TPavg</span> <span class="op">~</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">Canopycover</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">Pond</span><span class="op">)</span>, na.action<span class="op">=</span><span class="st">"na.fail"</span>, data<span class="op">=</span><span class="va">Pop_dataset</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## boundary (singular) fit: see help('isSingular')</span></span></code></pre>
<div class="sourceCode" id="cb135"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/RVAideMemoire/man/plotresid.html" class="external-link">plotresid</a></span><span class="op">(</span><span class="va">mod1</span><span class="op">)</span> <span class="co">#residuals ok</span></span></code></pre></div>
<p><img src="060_Statistical_models_isotopes_files/figure-html/check%20GOF%20for%20mean%20TP-1.png" width="700"></p>
<div class="sourceCode" id="cb136"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Linear mixed model fit by REML ['lmerMod']</span></span>
<span><span class="co">## Formula: TPavg ~ scale(Canopycover) + (1 | Pond)</span></span>
<span><span class="co">##    Data: Pop_dataset</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## REML criterion at convergence: 43.7</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Scaled residuals: </span></span>
<span><span class="co">##     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">## -2.6534 -0.6306 -0.1796  0.8133  1.8448 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Random effects:</span></span>
<span><span class="co">##  Groups   Name        Variance Std.Dev.</span></span>
<span><span class="co">##  Pond     (Intercept) 0.0000   0.0000  </span></span>
<span><span class="co">##  Residual             0.1483   0.3851  </span></span>
<span><span class="co">## Number of obs: 41, groups:  Pond, 15</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Fixed effects:</span></span>
<span><span class="co">##                    Estimate Std. Error t value</span></span>
<span><span class="co">## (Intercept)         2.40103    0.06015  39.918</span></span>
<span><span class="co">## scale(Canopycover) -0.15454    0.06090  -2.538</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Correlation of Fixed Effects:</span></span>
<span><span class="co">##             (Intr)</span></span>
<span><span class="co">## scl(Cnpycv) 0.000 </span></span>
<span><span class="co">## optimizer (nloptwrap) convergence code: 0 (OK)</span></span>
<span><span class="co">## boundary (singular) fit: see help('isSingular')</span></span></code></pre>
<p>Residuals look ok, we go with this model form.</p>
<div class="sourceCode" id="cb138"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Test effect of candidate variables</span></span>
<span><span class="va">mod_TP</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html" class="external-link">lmer</a></span><span class="op">(</span><span class="va">TPavg</span> <span class="op">~</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">Area</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">Canopycover</span><span class="op">)</span> <span class="op">+</span> </span>
<span>                 <span class="fu"><a href="https://rspatial.github.io/terra/reference/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">Aq_VegCover</span><span class="op">)</span> <span class="op">+</span></span>
<span>                 <span class="fu"><a href="https://rspatial.github.io/terra/reference/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">CrayfishCPUE</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/is.bool.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">Crayfish01</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">Agile_frog</span><span class="op">)</span> <span class="op">+</span> </span>
<span>                 <span class="fu"><a href="https://rspatial.github.io/terra/reference/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">Tree_frog</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">Palmate_newt</span><span class="op">)</span> <span class="op">+</span></span>
<span>                 <span class="fu"><a href="https://rspatial.github.io/terra/reference/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">Marbled_newtCPUE</span><span class="op">)</span> <span class="op">+</span></span>
<span>                 <span class="va">Group</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">Pond</span><span class="op">)</span>, </span>
<span>               na.action<span class="op">=</span><span class="st">"na.fail"</span>, data<span class="op">=</span><span class="va">Pop_dataset</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## boundary (singular) fit: see help('isSingular')</span></span></code></pre>
<div class="sourceCode" id="cb140"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">TP_dredge</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MuMIn/man/dredge.html" class="external-link">dredge</a></span><span class="op">(</span><span class="va">mod_TP</span>, rank <span class="op">=</span> <span class="va">AICc</span>, m.lim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">2</span><span class="op">)</span>, extra<span class="op">=</span><span class="st">"R^2"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in dredge(mod_TP, rank = AICc, m.lim = c(0, 2), extra = "R^2"):</span></span>
<span><span class="co">## comparing models fitted by REML</span></span></code></pre>
<pre><code><span><span class="co">## Fixed term is "(Intercept)"</span></span>
<span><span class="co">## boundary (singular) fit: see help('isSingular')</span></span>
<span><span class="co">## boundary (singular) fit: see help('isSingular')</span></span>
<span><span class="co">## boundary (singular) fit: see help('isSingular')</span></span>
<span><span class="co">## boundary (singular) fit: see help('isSingular')</span></span>
<span><span class="co">## boundary (singular) fit: see help('isSingular')</span></span>
<span><span class="co">## boundary (singular) fit: see help('isSingular')</span></span>
<span><span class="co">## boundary (singular) fit: see help('isSingular')</span></span>
<span><span class="co">## boundary (singular) fit: see help('isSingular')</span></span>
<span><span class="co">## boundary (singular) fit: see help('isSingular')</span></span>
<span><span class="co">## boundary (singular) fit: see help('isSingular')</span></span>
<span><span class="co">## boundary (singular) fit: see help('isSingular')</span></span>
<span><span class="co">## boundary (singular) fit: see help('isSingular')</span></span>
<span><span class="co">## boundary (singular) fit: see help('isSingular')</span></span>
<span><span class="co">## boundary (singular) fit: see help('isSingular')</span></span>
<span><span class="co">## boundary (singular) fit: see help('isSingular')</span></span>
<span><span class="co">## boundary (singular) fit: see help('isSingular')</span></span>
<span><span class="co">## boundary (singular) fit: see help('isSingular')</span></span>
<span><span class="co">## boundary (singular) fit: see help('isSingular')</span></span>
<span><span class="co">## boundary (singular) fit: see help('isSingular')</span></span>
<span><span class="co">## boundary (singular) fit: see help('isSingular')</span></span>
<span><span class="co">## boundary (singular) fit: see help('isSingular')</span></span>
<span><span class="co">## boundary (singular) fit: see help('isSingular')</span></span>
<span><span class="co">## boundary (singular) fit: see help('isSingular')</span></span>
<span><span class="co">## boundary (singular) fit: see help('isSingular')</span></span>
<span><span class="co">## boundary (singular) fit: see help('isSingular')</span></span>
<span><span class="co">## boundary (singular) fit: see help('isSingular')</span></span>
<span><span class="co">## boundary (singular) fit: see help('isSingular')</span></span>
<span><span class="co">## boundary (singular) fit: see help('isSingular')</span></span>
<span><span class="co">## boundary (singular) fit: see help('isSingular')</span></span>
<span><span class="co">## boundary (singular) fit: see help('isSingular')</span></span>
<span><span class="co">## boundary (singular) fit: see help('isSingular')</span></span>
<span><span class="co">## boundary (singular) fit: see help('isSingular')</span></span>
<span><span class="co">## boundary (singular) fit: see help('isSingular')</span></span>
<span><span class="co">## boundary (singular) fit: see help('isSingular')</span></span>
<span><span class="co">## boundary (singular) fit: see help('isSingular')</span></span>
<span><span class="co">## boundary (singular) fit: see help('isSingular')</span></span>
<span><span class="co">## boundary (singular) fit: see help('isSingular')</span></span>
<span><span class="co">## boundary (singular) fit: see help('isSingular')</span></span>
<span><span class="co">## boundary (singular) fit: see help('isSingular')</span></span>
<span><span class="co">## boundary (singular) fit: see help('isSingular')</span></span>
<span><span class="co">## boundary (singular) fit: see help('isSingular')</span></span>
<span><span class="co">## boundary (singular) fit: see help('isSingular')</span></span>
<span><span class="co">## boundary (singular) fit: see help('isSingular')</span></span>
<span><span class="co">## boundary (singular) fit: see help('isSingular')</span></span>
<span><span class="co">## boundary (singular) fit: see help('isSingular')</span></span>
<span><span class="co">## boundary (singular) fit: see help('isSingular')</span></span>
<span><span class="co">## boundary (singular) fit: see help('isSingular')</span></span></code></pre>
<div class="sourceCode" id="cb143"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">TP_dredge</span>, <span class="va">delta</span> <span class="op">&lt;</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Global model call: lmer(formula = TPavg ~ scale(Area) + scale(Canopycover) + scale(Aq_VegCover) + </span></span>
<span><span class="co">##     scale(CrayfishCPUE) + as.factor(Crayfish01) + scale(Agile_frog) + </span></span>
<span><span class="co">##     scale(Tree_frog) + scale(Palmate_newt) + scale(Marbled_newtCPUE) + </span></span>
<span><span class="co">##     Group + (1 | Pond), data = Pop_dataset, na.action = "na.fail")</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Model selection table </span></span>
<span><span class="co">##    (Int) Grp scl(Cnp)    R^2 df  logLik AICc delta weight</span></span>
<span><span class="co">## 35 2.592   +  -0.1493 0.3145  5 -18.741 49.2  0.00  0.534</span></span>
<span><span class="co">## 3  2.598   +          0.1823  4 -20.179 49.5  0.27  0.466</span></span>
<span><span class="co">## Models ranked by AICc(x) </span></span>
<span><span class="co">## Random terms (all models): </span></span>
<span><span class="co">##   1 | Pond</span></span></code></pre>
<p>Two models are kept by the selection, they contain the variables
group and canopy cover. We check the content of these models as well as
the first model containing either Crayfish abundance or Crayfish
presence, and the null model.</p>
<div class="sourceCode" id="cb145"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">TP_dredge</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MuMIn/man/dredge.html" class="external-link">dredge</a></span><span class="op">(</span><span class="va">mod_TP</span>, rank <span class="op">=</span> <span class="va">AICc</span>, m.lim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">2</span><span class="op">)</span>, extra<span class="op">=</span><span class="st">"R^2"</span>, evaluate<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in dredge(mod_TP, rank = AICc, m.lim = c(0, 2), extra = "R^2", evaluate</span></span>
<span><span class="co">## = FALSE): comparing models fitted by REML</span></span></code></pre>
<pre><code><span><span class="co">## Fixed term is "(Intercept)"</span></span></code></pre>
<div class="sourceCode" id="cb148"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># First model</span></span>
<span><span class="va">Model_selected1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html" class="external-link">lmer</a></span><span class="op">(</span><span class="va">TPavg</span> <span class="op">~</span> </span>
<span>                          <span class="va">Group</span> <span class="op">+</span></span>
<span>                          <span class="fu"><a href="https://rspatial.github.io/terra/reference/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">Canopycover</span><span class="op">)</span></span>
<span>                        <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">Pond</span><span class="op">)</span>, </span>
<span>                         na.action<span class="op">=</span><span class="st">"na.fail"</span>, data<span class="op">=</span><span class="va">Pop_dataset</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## boundary (singular) fit: see help('isSingular')</span></span></code></pre>
<div class="sourceCode" id="cb150"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/RVAideMemoire/man/plotresid.html" class="external-link">plotresid</a></span><span class="op">(</span><span class="va">Model_selected1</span><span class="op">)</span></span></code></pre></div>
<p><img src="060_Statistical_models_isotopes_files/figure-html/check%20the%20content%20of%20each%20model%20for%20TP-1.png" width="700"></p>
<div class="sourceCode" id="cb151"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">Model_selected1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Linear mixed model fit by REML ['lmerMod']</span></span>
<span><span class="co">## Formula: TPavg ~ Group + scale(Canopycover) + (1 | Pond)</span></span>
<span><span class="co">##    Data: Pop_dataset</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## REML criterion at convergence: 37.5</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Scaled residuals: </span></span>
<span><span class="co">##     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">## -2.4923 -0.6660 -0.1329  0.7214  2.0104 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Random effects:</span></span>
<span><span class="co">##  Groups   Name        Variance Std.Dev.</span></span>
<span><span class="co">##  Pond     (Intercept) 0.0000   0.0000  </span></span>
<span><span class="co">##  Residual             0.1216   0.3487  </span></span>
<span><span class="co">## Number of obs: 41, groups:  Pond, 15</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Fixed effects:</span></span>
<span><span class="co">##                    Estimate Std. Error t value</span></span>
<span><span class="co">## (Intercept)         2.59166    0.08221  31.526</span></span>
<span><span class="co">## GroupTadpoles      -0.33981    0.10978  -3.095</span></span>
<span><span class="co">## scale(Canopycover) -0.14935    0.05516  -2.708</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Correlation of Fixed Effects:</span></span>
<span><span class="co">##             (Intr) GrpTdp</span></span>
<span><span class="co">## GroupTadpls -0.749       </span></span>
<span><span class="co">## scl(Cnpycv)  0.023 -0.030</span></span>
<span><span class="co">## optimizer (nloptwrap) convergence code: 0 (OK)</span></span>
<span><span class="co">## boundary (singular) fit: see help('isSingular')</span></span></code></pre>
<div class="sourceCode" id="cb153"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">Model_selected1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/math-generics.html" class="external-link">round</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">coefficients</span>,<span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                    Estimate Std. Error t value</span></span>
<span><span class="co">## (Intercept)            2.59       0.08   31.53</span></span>
<span><span class="co">## GroupTadpoles         -0.34       0.11   -3.10</span></span>
<span><span class="co">## scale(Canopycover)    -0.15       0.06   -2.71</span></span></code></pre>
<div class="sourceCode" id="cb155"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">performance</span><span class="fu">::</span><span class="fu"><a href="https://easystats.github.io/performance/reference/r2_nakagawa.html" class="external-link">r2_nakagawa</a></span><span class="op">(</span><span class="va">Model_selected1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Can't compute random effect variances. Some variance components equal</span></span>
<span><span class="co">##   zero. Your model may suffer from singularity (see `?lme4::isSingular`</span></span>
<span><span class="co">##   and `?performance::check_singularity`).</span></span>
<span><span class="co">##   Solution: Respecify random structure! You may also decrease the</span></span>
<span><span class="co">##   `tolerance` level to enforce the calculation of random effect variances.</span></span></code></pre>
<pre><code><span><span class="co">## Random effect variances not available. Returned R2 does not account for random effects.</span></span></code></pre>
<pre><code><span><span class="co">## # R2 for Mixed Models</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   Conditional R2: NA</span></span>
<span><span class="co">##      Marginal R2: 0.304</span></span></code></pre>
<div class="sourceCode" id="cb159"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Second model</span></span>
<span><span class="va">Model_selected2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html" class="external-link">lmer</a></span><span class="op">(</span><span class="va">TPavg</span> <span class="op">~</span> </span>
<span>                          <span class="va">Group</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">Pond</span><span class="op">)</span>, </span>
<span>                         na.action<span class="op">=</span><span class="st">"na.fail"</span>, data<span class="op">=</span><span class="va">Pop_dataset</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/RVAideMemoire/man/plotresid.html" class="external-link">plotresid</a></span><span class="op">(</span><span class="va">Model_selected2</span><span class="op">)</span></span></code></pre></div>
<p><img src="060_Statistical_models_isotopes_files/figure-html/check%20the%20content%20of%20each%20model%20for%20TP-2.png" width="700"></p>
<div class="sourceCode" id="cb160"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">Model_selected2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Linear mixed model fit by REML ['lmerMod']</span></span>
<span><span class="co">## Formula: TPavg ~ Group + (1 | Pond)</span></span>
<span><span class="co">##    Data: Pop_dataset</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## REML criterion at convergence: 40.4</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Scaled residuals: </span></span>
<span><span class="co">##      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">## -2.04046 -0.60509 -0.09104  0.77756  1.90488 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Random effects:</span></span>
<span><span class="co">##  Groups   Name        Variance Std.Dev.</span></span>
<span><span class="co">##  Pond     (Intercept) 0.00361  0.06008 </span></span>
<span><span class="co">##  Residual             0.13782  0.37124 </span></span>
<span><span class="co">## Number of obs: 41, groups:  Pond, 15</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Fixed effects:</span></span>
<span><span class="co">##               Estimate Std. Error t value</span></span>
<span><span class="co">## (Intercept)    2.59850    0.08949  29.037</span></span>
<span><span class="co">## GroupTadpoles -0.35129    0.11723  -2.996</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Correlation of Fixed Effects:</span></span>
<span><span class="co">##             (Intr)</span></span>
<span><span class="co">## GroupTadpls -0.738</span></span></code></pre>
<div class="sourceCode" id="cb162"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">Model_selected2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/math-generics.html" class="external-link">round</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">coefficients</span>,<span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##               Estimate Std. Error t value</span></span>
<span><span class="co">## (Intercept)       2.60       0.09   29.04</span></span>
<span><span class="co">## GroupTadpoles    -0.35       0.12   -3.00</span></span></code></pre>
<div class="sourceCode" id="cb164"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">performance</span><span class="fu">::</span><span class="fu"><a href="https://easystats.github.io/performance/reference/r2_nakagawa.html" class="external-link">r2_nakagawa</a></span><span class="op">(</span><span class="va">Model_selected2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## # R2 for Mixed Models</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   Conditional R2: 0.201</span></span>
<span><span class="co">##      Marginal R2: 0.181</span></span></code></pre>
<div class="sourceCode" id="cb166"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Null model</span></span>
<span><span class="va">Model_null</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html" class="external-link">lmer</a></span><span class="op">(</span><span class="va">TPavg</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">Pond</span><span class="op">)</span>, </span>
<span>                         na.action<span class="op">=</span><span class="st">"na.fail"</span>, data<span class="op">=</span><span class="va">Pop_dataset</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## boundary (singular) fit: see help('isSingular')</span></span></code></pre>
<div class="sourceCode" id="cb168"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">Model_null</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Linear mixed model fit by REML ['lmerMod']</span></span>
<span><span class="co">## Formula: TPavg ~ 1 + (1 | Pond)</span></span>
<span><span class="co">##    Data: Pop_dataset</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## REML criterion at convergence: 46</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Scaled residuals: </span></span>
<span><span class="co">##     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">## -2.2190 -0.7681 -0.1369  0.7437  1.9948 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Random effects:</span></span>
<span><span class="co">##  Groups   Name        Variance Std.Dev.</span></span>
<span><span class="co">##  Pond     (Intercept) 0.0000   0.0000  </span></span>
<span><span class="co">##  Residual             0.1685   0.4105  </span></span>
<span><span class="co">## Number of obs: 41, groups:  Pond, 15</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Fixed effects:</span></span>
<span><span class="co">##             Estimate Std. Error t value</span></span>
<span><span class="co">## (Intercept)  2.40103    0.06411   37.45</span></span>
<span><span class="co">## optimizer (nloptwrap) convergence code: 0 (OK)</span></span>
<span><span class="co">## boundary (singular) fit: see help('isSingular')</span></span></code></pre>
<div class="sourceCode" id="cb170"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">Model_null</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/math-generics.html" class="external-link">round</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">coefficients</span>,<span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##             Estimate Std. Error t value</span></span>
<span><span class="co">## (Intercept)      2.4       0.06   37.45</span></span></code></pre>
<div class="sourceCode" id="cb172"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">performance</span><span class="fu">::</span><span class="fu"><a href="https://easystats.github.io/performance/reference/r2_nakagawa.html" class="external-link">r2_nakagawa</a></span><span class="op">(</span><span class="va">Model_null</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Can't compute random effect variances. Some variance components equal</span></span>
<span><span class="co">##   zero. Your model may suffer from singularity (see `?lme4::isSingular`</span></span>
<span><span class="co">##   and `?performance::check_singularity`).</span></span>
<span><span class="co">##   Solution: Respecify random structure! You may also decrease the</span></span>
<span><span class="co">##   `tolerance` level to enforce the calculation of random effect variances.</span></span></code></pre>
<pre><code><span><span class="co">## Random effect variances not available. Returned R2 does not account for random effects.</span></span></code></pre>
<pre><code><span><span class="co">## # R2 for Mixed Models</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   Conditional R2: NA</span></span>
<span><span class="co">##      Marginal R2: 0.000</span></span></code></pre>
<div class="sourceCode" id="cb176"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#First model with crayfish abundance</span></span>
<span><span class="va">Model_CCPUE</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html" class="external-link">lmer</a></span><span class="op">(</span><span class="va">TPavg</span> <span class="op">~</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">CrayfishCPUE</span><span class="op">)</span> <span class="op">+</span> <span class="va">Group</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">Pond</span><span class="op">)</span>, </span>
<span>                        na.action<span class="op">=</span><span class="st">"na.fail"</span>, </span>
<span>                        data<span class="op">=</span><span class="va">Pop_dataset</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/RVAideMemoire/man/plotresid.html" class="external-link">plotresid</a></span><span class="op">(</span><span class="va">Model_CCPUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="060_Statistical_models_isotopes_files/figure-html/check%20the%20content%20of%20each%20model%20for%20TP-3.png" width="700"></p>
<div class="sourceCode" id="cb177"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">Model_CCPUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Linear mixed model fit by REML ['lmerMod']</span></span>
<span><span class="co">## Formula: TPavg ~ scale(CrayfishCPUE) + Group + (1 | Pond)</span></span>
<span><span class="co">##    Data: Pop_dataset</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## REML criterion at convergence: 43.8</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Scaled residuals: </span></span>
<span><span class="co">##      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">## -1.97568 -0.67798 -0.02395  0.64502  1.96346 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Random effects:</span></span>
<span><span class="co">##  Groups   Name        Variance Std.Dev.</span></span>
<span><span class="co">##  Pond     (Intercept) 0.00662  0.08136 </span></span>
<span><span class="co">##  Residual             0.13808  0.37159 </span></span>
<span><span class="co">## Number of obs: 41, groups:  Pond, 15</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Fixed effects:</span></span>
<span><span class="co">##                     Estimate Std. Error t value</span></span>
<span><span class="co">## (Intercept)          2.60573    0.09199  28.328</span></span>
<span><span class="co">## scale(CrayfishCPUE)  0.02980    0.06337   0.470</span></span>
<span><span class="co">## GroupTadpoles       -0.36522    0.12041  -3.033</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Correlation of Fixed Effects:</span></span>
<span><span class="co">##             (Intr) s(CCPU</span></span>
<span><span class="co">## scl(CrCPUE)  0.134       </span></span>
<span><span class="co">## GroupTadpls -0.736 -0.213</span></span></code></pre>
<div class="sourceCode" id="cb179"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">Model_CCPUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/math-generics.html" class="external-link">round</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">coefficients</span>,<span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                     Estimate Std. Error t value</span></span>
<span><span class="co">## (Intercept)             2.61       0.09   28.33</span></span>
<span><span class="co">## scale(CrayfishCPUE)     0.03       0.06    0.47</span></span>
<span><span class="co">## GroupTadpoles          -0.37       0.12   -3.03</span></span></code></pre>
<div class="sourceCode" id="cb181"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#First model with crayfish presence</span></span>
<span><span class="va">Model_C01</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html" class="external-link">lmer</a></span><span class="op">(</span><span class="va">TPavg</span> <span class="op">~</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/is.bool.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">Crayfish01</span><span class="op">)</span> <span class="op">+</span> <span class="va">Group</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">Pond</span><span class="op">)</span>, </span>
<span>                        na.action<span class="op">=</span><span class="st">"na.fail"</span>, </span>
<span>                        data<span class="op">=</span><span class="va">Pop_dataset</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/RVAideMemoire/man/plotresid.html" class="external-link">plotresid</a></span><span class="op">(</span><span class="va">Model_C01</span><span class="op">)</span></span></code></pre></div>
<p><img src="060_Statistical_models_isotopes_files/figure-html/check%20the%20content%20of%20each%20model%20for%20TP-4.png" width="700"></p>
<div class="sourceCode" id="cb182"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">Model_C01</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Linear mixed model fit by REML ['lmerMod']</span></span>
<span><span class="co">## Formula: TPavg ~ as.factor(Crayfish01) + Group + (1 | Pond)</span></span>
<span><span class="co">##    Data: Pop_dataset</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## REML criterion at convergence: 42.2</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Scaled residuals: </span></span>
<span><span class="co">##     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">## -2.1440 -0.6495 -0.1540  0.8902  1.7646 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Random effects:</span></span>
<span><span class="co">##  Groups   Name        Variance Std.Dev.</span></span>
<span><span class="co">##  Pond     (Intercept) 0.00242  0.0492  </span></span>
<span><span class="co">##  Residual             0.14056  0.3749  </span></span>
<span><span class="co">## Number of obs: 41, groups:  Pond, 15</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Fixed effects:</span></span>
<span><span class="co">##                              Estimate Std. Error t value</span></span>
<span><span class="co">## (Intercept)                   2.62927    0.09914  26.522</span></span>
<span><span class="co">## as.factor(Crayfish01)present -0.09155    0.12315  -0.743</span></span>
<span><span class="co">## GroupTadpoles                -0.33381    0.12037  -2.773</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Correlation of Fixed Effects:</span></span>
<span><span class="co">##             (Intr) a.(C01</span></span>
<span><span class="co">## as.fct(C01) -0.426       </span></span>
<span><span class="co">## GroupTadpls -0.580 -0.186</span></span></code></pre>
<div class="sourceCode" id="cb184"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">Model_C01</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/math-generics.html" class="external-link">round</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">coefficients</span>,<span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                              Estimate Std. Error t value</span></span>
<span><span class="co">## (Intercept)                      2.63       0.10   26.52</span></span>
<span><span class="co">## as.factor(Crayfish01)present    -0.09       0.12   -0.74</span></span>
<span><span class="co">## GroupTadpoles                   -0.33       0.12   -2.77</span></span></code></pre>
<div class="section level4">
<h4 id="figure-with-tp">Figure with TP<a class="anchor" aria-label="anchor" href="#figure-with-tp"></a>
</h4>
<div class="sourceCode" id="cb186"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Figure with group</span></span>
<span><span class="va">Pop_dataset</span><span class="op">$</span><span class="va">Group</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">Pop_dataset</span><span class="op">$</span><span class="va">Group</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Tadpoles"</span>, <span class="st">"Newts"</span><span class="op">)</span><span class="op">)</span> </span>
<span>  </span>
<span>    <span class="va">TP_group</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">Pop_dataset</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">TPavg</span>, x <span class="op">=</span> <span class="va">Group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></span><span class="op">(</span>show.legend <span class="op">=</span> <span class="cn">F</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html" class="external-link">geom_jitter</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col <span class="op">=</span> <span class="va">Species</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#0072B2"</span>, <span class="st">"#009E73"</span>, </span>
<span>                                <span class="st">"#56B4E9"</span>, <span class="st">"#CC79A7"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Group"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Mean TP"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position<span class="op">=</span><span class="st">"none"</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">TP_group</span></span></code></pre></div>
<p><img src="060_Statistical_models_isotopes_files/figure-html/corresponding%20figures%20for%20TP-1.png" width="700"></p>
<div class="sourceCode" id="cb187"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Figure with canopy cover</span></span>
<span><span class="va">TP_canopy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">Pop_dataset</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">TPavg</span>, x <span class="op">=</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">Canopycover</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span>method<span class="op">=</span><span class="st">"lm"</span>,se<span class="op">=</span><span class="cn">F</span>, col <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col <span class="op">=</span> <span class="va">Species</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#0072B2"</span>, <span class="st">"#009E73"</span>, </span>
<span>                                <span class="st">"#56B4E9"</span>, <span class="st">"#CC79A7"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Canopy cover, scaled"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position<span class="op">=</span><span class="st">"none"</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">TP_canopy</span></span></code></pre></div>
<pre><code><span><span class="co">## `geom_smooth()` using formula = 'y ~ x'</span></span></code></pre>
<p><img src="060_Statistical_models_isotopes_files/figure-html/corresponding%20figures%20for%20TP-2.png" width="700"></p>
<div class="sourceCode" id="cb189"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Figure with crayfish presence</span></span>
<span>  <span class="va">TP_crayfish</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">Pop_dataset</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">TPavg</span>, x <span class="op">=</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/is.bool.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">Crayfish01</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></span><span class="op">(</span>show.legend <span class="op">=</span> <span class="cn">F</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html" class="external-link">geom_jitter</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col <span class="op">=</span> <span class="va">Species</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#0072B2"</span>, <span class="st">"#009E73"</span>, </span>
<span>                                <span class="st">"#56B4E9"</span>, <span class="st">"#CC79A7"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Crayfish"</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position<span class="op">=</span><span class="st">"none"</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">TP_crayfish</span></span></code></pre></div>
<p><img src="060_Statistical_models_isotopes_files/figure-html/corresponding%20figures%20for%20TP-3.png" width="700"></p>
<div class="sourceCode" id="cb190"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># We put all three figures on a single row</span></span>
<span><span class="va">TP</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">grid.arrange</a></span><span class="op">(</span><span class="va">TP_group</span>, <span class="va">TP_canopy</span>, <span class="va">TP_crayfish</span>, ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## `geom_smooth()` using formula = 'y ~ x'</span></span></code></pre>
<p><img src="060_Statistical_models_isotopes_files/figure-html/corresponding%20figures%20for%20TP-4.png" width="700"></p>
</div>
</div>
<div class="section level3">
<h3 id="mean-d13c">Mean d13C<a class="anchor" aria-label="anchor" href="#mean-d13c"></a>
</h3>
<p>We check the GOF of the model with D13C</p>
<div class="sourceCode" id="cb192"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html" class="external-link">lmer</a></span><span class="op">(</span><span class="va">D13Cavg</span> <span class="op">~</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">Canopycover</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">Pond</span><span class="op">)</span>, na.action<span class="op">=</span><span class="st">"na.fail"</span>, data<span class="op">=</span><span class="va">Pop_dataset</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/RVAideMemoire/man/plotresid.html" class="external-link">plotresid</a></span><span class="op">(</span><span class="va">mod1</span><span class="op">)</span> <span class="co">#residuals ok</span></span></code></pre></div>
<p><img src="060_Statistical_models_isotopes_files/figure-html/check%20GOF%20for%20D13C-1.png" width="700"></p>
<div class="sourceCode" id="cb193"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Linear mixed model fit by REML ['lmerMod']</span></span>
<span><span class="co">## Formula: D13Cavg ~ scale(Canopycover) + (1 | Pond)</span></span>
<span><span class="co">##    Data: Pop_dataset</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## REML criterion at convergence: 88.5</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Scaled residuals: </span></span>
<span><span class="co">##     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">## -2.1623 -0.6573 -0.1387  0.6902  1.7617 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Random effects:</span></span>
<span><span class="co">##  Groups   Name        Variance Std.Dev.</span></span>
<span><span class="co">##  Pond     (Intercept) 0.2156   0.4643  </span></span>
<span><span class="co">##  Residual             0.3413   0.5842  </span></span>
<span><span class="co">## Number of obs: 41, groups:  Pond, 15</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Fixed effects:</span></span>
<span><span class="co">##                    Estimate Std. Error t value</span></span>
<span><span class="co">## (Intercept)        -0.02022    0.15478  -0.131</span></span>
<span><span class="co">## scale(Canopycover)  0.12865    0.15997   0.804</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Correlation of Fixed Effects:</span></span>
<span><span class="co">##             (Intr)</span></span>
<span><span class="co">## scl(Cnpycv) -0.066</span></span></code></pre>
<p>We go with the model with untransformed D13C and pond as a random
factor.</p>
<div class="sourceCode" id="cb195"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Test effect of candidate variables</span></span>
<span><span class="va">mod_D13C</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html" class="external-link">lmer</a></span><span class="op">(</span><span class="va">D13Cavg</span> <span class="op">~</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">Area</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">Canopycover</span><span class="op">)</span> <span class="op">+</span> </span>
<span>                   <span class="fu"><a href="https://rspatial.github.io/terra/reference/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">Aq_VegCover</span><span class="op">)</span> <span class="op">+</span></span>
<span>                   <span class="fu"><a href="https://rspatial.github.io/terra/reference/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">CrayfishCPUE</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/is.bool.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">Crayfish01</span><span class="op">)</span> <span class="op">+</span></span>
<span>                   <span class="fu"><a href="https://rspatial.github.io/terra/reference/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">Agile_frog</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">Tree_frog</span><span class="op">)</span> <span class="op">+</span> </span>
<span>                   <span class="fu"><a href="https://rspatial.github.io/terra/reference/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">Palmate_newt</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">Marbled_newtCPUE</span><span class="op">)</span> <span class="op">+</span></span>
<span>                   <span class="va">Group</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">Pond</span><span class="op">)</span>, </span>
<span>                 na.action<span class="op">=</span><span class="st">"na.fail"</span>, data<span class="op">=</span><span class="va">Pop_dataset</span><span class="op">)</span></span>
<span></span>
<span><span class="va">D13C_dredge</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MuMIn/man/dredge.html" class="external-link">dredge</a></span><span class="op">(</span><span class="va">mod_D13C</span>, rank <span class="op">=</span> <span class="va">AICc</span>, m.lim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">2</span><span class="op">)</span>, extra<span class="op">=</span><span class="st">"R^2"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in dredge(mod_D13C, rank = AICc, m.lim = c(0, 2), extra = "R^2"):</span></span>
<span><span class="co">## comparing models fitted by REML</span></span></code></pre>
<pre><code><span><span class="co">## Fixed term is "(Intercept)"</span></span></code></pre>
<div class="sourceCode" id="cb198"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">D13C_dredge</span>, <span class="va">delta</span> <span class="op">&lt;</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Global model call: lmer(formula = D13Cavg ~ scale(Area) + scale(Canopycover) + scale(Aq_VegCover) + </span></span>
<span><span class="co">##     scale(CrayfishCPUE) + as.factor(Crayfish01) + scale(Agile_frog) + </span></span>
<span><span class="co">##     scale(Tree_frog) + scale(Palmate_newt) + scale(Marbled_newtCPUE) + </span></span>
<span><span class="co">##     Group + (1 | Pond), data = Pop_dataset, na.action = "na.fail")</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Model selection table </span></span>
<span><span class="co">##     (Int) Grp    R^2 df  logLik AICc delta weight</span></span>
<span><span class="co">## 3 -0.3834   + 0.6997  4 -23.866 56.8     0      1</span></span>
<span><span class="co">## Models ranked by AICc(x) </span></span>
<span><span class="co">## Random terms (all models): </span></span>
<span><span class="co">##   1 | Pond</span></span></code></pre>
<p>Here, a single model is kept, it contains the variable group only. We
check the content of this model as well as the first model containing
either Crayfish abundance or Crayfish presence, and the null model.</p>
<div class="sourceCode" id="cb200"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">D13C_dredge</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MuMIn/man/dredge.html" class="external-link">dredge</a></span><span class="op">(</span><span class="va">mod_D13C</span>, rank <span class="op">=</span> <span class="va">AICc</span>, m.lim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">2</span><span class="op">)</span>, extra<span class="op">=</span><span class="st">"R^2"</span>, evaluate<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in dredge(mod_D13C, rank = AICc, m.lim = c(0, 2), extra = "R^2", :</span></span>
<span><span class="co">## comparing models fitted by REML</span></span></code></pre>
<pre><code><span><span class="co">## Fixed term is "(Intercept)"</span></span></code></pre>
<div class="sourceCode" id="cb203"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#First model</span></span>
<span><span class="va">Model_selected1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html" class="external-link">lmer</a></span><span class="op">(</span><span class="va">D13Cavg</span> <span class="op">~</span> </span>
<span>                        <span class="va">Group</span></span>
<span>                        <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">Pond</span><span class="op">)</span>, </span>
<span>                      na.action<span class="op">=</span><span class="st">"na.fail"</span>, data<span class="op">=</span><span class="va">Pop_dataset</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/RVAideMemoire/man/plotresid.html" class="external-link">plotresid</a></span><span class="op">(</span><span class="va">Model_selected1</span><span class="op">)</span></span></code></pre></div>
<p><img src="060_Statistical_models_isotopes_files/figure-html/check%20the%20content%20of%20each%20model%20for%20D13C-1.png" width="700"></p>
<div class="sourceCode" id="cb204"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">Model_selected1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Linear mixed model fit by REML ['lmerMod']</span></span>
<span><span class="co">## Formula: D13Cavg ~ Group + (1 | Pond)</span></span>
<span><span class="co">##    Data: Pop_dataset</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## REML criterion at convergence: 47.7</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Scaled residuals: </span></span>
<span><span class="co">##      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">## -1.97053 -0.60878  0.05035  0.45839  2.01221 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Random effects:</span></span>
<span><span class="co">##  Groups   Name        Variance Std.Dev.</span></span>
<span><span class="co">##  Pond     (Intercept) 0.22387  0.4731  </span></span>
<span><span class="co">##  Residual             0.08214  0.2866  </span></span>
<span><span class="co">## Number of obs: 41, groups:  Pond, 15</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Fixed effects:</span></span>
<span><span class="co">##             Estimate Std. Error t value</span></span>
<span><span class="co">## (Intercept) -0.38345    0.13687  -2.802</span></span>
<span><span class="co">## GroupNewts   0.91100    0.09598   9.491</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Correlation of Fixed Effects:</span></span>
<span><span class="co">##            (Intr)</span></span>
<span><span class="co">## GroupNewts -0.268</span></span></code></pre>
<div class="sourceCode" id="cb206"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">Model_selected1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/math-generics.html" class="external-link">round</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">coefficients</span>,<span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##             Estimate Std. Error t value</span></span>
<span><span class="co">## (Intercept)    -0.38       0.14   -2.80</span></span>
<span><span class="co">## GroupNewts      0.91       0.10    9.49</span></span></code></pre>
<div class="sourceCode" id="cb208"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">performance</span><span class="fu">::</span><span class="fu"><a href="https://easystats.github.io/performance/reference/r2_nakagawa.html" class="external-link">r2_nakagawa</a></span><span class="op">(</span><span class="va">Model_selected1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## # R2 for Mixed Models</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   Conditional R2: 0.841</span></span>
<span><span class="co">##      Marginal R2: 0.406</span></span></code></pre>
<div class="sourceCode" id="cb210"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Null model</span></span>
<span><span class="va">Model_null</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html" class="external-link">lmer</a></span><span class="op">(</span><span class="va">D13Cavg</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">Pond</span><span class="op">)</span>, </span>
<span>                      na.action<span class="op">=</span><span class="st">"na.fail"</span>, data<span class="op">=</span><span class="va">Pop_dataset</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">Model_null</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Linear mixed model fit by REML ['lmerMod']</span></span>
<span><span class="co">## Formula: D13Cavg ~ 1 + (1 | Pond)</span></span>
<span><span class="co">##    Data: Pop_dataset</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## REML criterion at convergence: 87.3</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Scaled residuals: </span></span>
<span><span class="co">##     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">## -2.2519 -0.6916 -0.1738  0.7094  1.6939 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Random effects:</span></span>
<span><span class="co">##  Groups   Name        Variance Std.Dev.</span></span>
<span><span class="co">##  Pond     (Intercept) 0.2097   0.458   </span></span>
<span><span class="co">##  Residual             0.3399   0.583   </span></span>
<span><span class="co">## Number of obs: 41, groups:  Pond, 15</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Fixed effects:</span></span>
<span><span class="co">##             Estimate Std. Error t value</span></span>
<span><span class="co">## (Intercept) -0.01168    0.15302  -0.076</span></span></code></pre>
<div class="sourceCode" id="cb212"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># First model with crayfish abundance</span></span>
<span><span class="va">Model_CCPUE</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html" class="external-link">lmer</a></span><span class="op">(</span><span class="va">D13Cavg</span> <span class="op">~</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">CrayfishCPUE</span><span class="op">)</span> <span class="op">+</span> <span class="va">Group</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">Pond</span><span class="op">)</span>, </span>
<span>                      na.action<span class="op">=</span><span class="st">"na.fail"</span>, data<span class="op">=</span><span class="va">Pop_dataset</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">Model_CCPUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Linear mixed model fit by REML ['lmerMod']</span></span>
<span><span class="co">## Formula: D13Cavg ~ scale(CrayfishCPUE) + Group + (1 | Pond)</span></span>
<span><span class="co">##    Data: Pop_dataset</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## REML criterion at convergence: 50.1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Scaled residuals: </span></span>
<span><span class="co">##      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">## -1.93106 -0.58689  0.02145  0.43031  2.01025 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Random effects:</span></span>
<span><span class="co">##  Groups   Name        Variance Std.Dev.</span></span>
<span><span class="co">##  Pond     (Intercept) 0.24140  0.4913  </span></span>
<span><span class="co">##  Residual             0.08245  0.2871  </span></span>
<span><span class="co">## Number of obs: 41, groups:  Pond, 15</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Fixed effects:</span></span>
<span><span class="co">##                     Estimate Std. Error t value</span></span>
<span><span class="co">## (Intercept)         -0.38998    0.14755  -2.643</span></span>
<span><span class="co">## scale(CrayfishCPUE)  0.01882    0.12471   0.151</span></span>
<span><span class="co">## GroupNewts           0.91213    0.09669   9.434</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Correlation of Fixed Effects:</span></span>
<span><span class="co">##             (Intr) s(CCPU</span></span>
<span><span class="co">## scl(CrCPUE) -0.292       </span></span>
<span><span class="co">## GroupNewts  -0.276  0.096</span></span></code></pre>
<div class="sourceCode" id="cb214"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">Model_CCPUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/math-generics.html" class="external-link">round</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">coefficients</span>,<span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                     Estimate Std. Error t value</span></span>
<span><span class="co">## (Intercept)            -0.39       0.15   -2.64</span></span>
<span><span class="co">## scale(CrayfishCPUE)     0.02       0.12    0.15</span></span>
<span><span class="co">## GroupNewts              0.91       0.10    9.43</span></span></code></pre>
<div class="sourceCode" id="cb216"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># First model with crayfish presence</span></span>
<span><span class="va">Model_C01</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html" class="external-link">lmer</a></span><span class="op">(</span><span class="va">D13Cavg</span> <span class="op">~</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/is.bool.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">Crayfish01</span><span class="op">)</span> <span class="op">+</span> <span class="va">Group</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">Pond</span><span class="op">)</span>, </span>
<span>                      na.action<span class="op">=</span><span class="st">"na.fail"</span>, data<span class="op">=</span><span class="va">Pop_dataset</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">Model_C01</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Linear mixed model fit by REML ['lmerMod']</span></span>
<span><span class="co">## Formula: D13Cavg ~ as.factor(Crayfish01) + Group + (1 | Pond)</span></span>
<span><span class="co">##    Data: Pop_dataset</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## REML criterion at convergence: 48.4</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Scaled residuals: </span></span>
<span><span class="co">##     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">## -1.9249 -0.6025  0.0223  0.4341  2.0184 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Random effects:</span></span>
<span><span class="co">##  Groups   Name        Variance Std.Dev.</span></span>
<span><span class="co">##  Pond     (Intercept) 0.24091  0.4908  </span></span>
<span><span class="co">##  Residual             0.08239  0.2870  </span></span>
<span><span class="co">## Number of obs: 41, groups:  Pond, 15</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Fixed effects:</span></span>
<span><span class="co">##                              Estimate Std. Error t value</span></span>
<span><span class="co">## (Intercept)                  -0.42446    0.21532  -1.971</span></span>
<span><span class="co">## as.factor(Crayfish01)present  0.06965    0.27665   0.252</span></span>
<span><span class="co">## GroupNewts                    0.91288    0.09658   9.452</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Correlation of Fixed Effects:</span></span>
<span><span class="co">##             (Intr) a.(C01</span></span>
<span><span class="co">## as.fct(C01) -0.756       </span></span>
<span><span class="co">## GroupNewts  -0.236  0.088</span></span></code></pre>
<div class="sourceCode" id="cb218"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">Model_C01</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/math-generics.html" class="external-link">round</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">coefficients</span>,<span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                              Estimate Std. Error t value</span></span>
<span><span class="co">## (Intercept)                     -0.42       0.22   -1.97</span></span>
<span><span class="co">## as.factor(Crayfish01)present     0.07       0.28    0.25</span></span>
<span><span class="co">## GroupNewts                       0.91       0.10    9.45</span></span></code></pre>
<div class="section level4">
<h4 id="figure-with-d13c">Figure with D13C<a class="anchor" aria-label="anchor" href="#figure-with-d13c"></a>
</h4>
<div class="sourceCode" id="cb220"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Figure with group</span></span>
<span><span class="va">D13C_group</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">Pop_dataset</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">D13Cavg</span>, x <span class="op">=</span> <span class="va">Group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></span><span class="op">(</span>show.legend <span class="op">=</span> <span class="cn">F</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html" class="external-link">geom_jitter</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col <span class="op">=</span> <span class="va">Species</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#0072B2"</span>, <span class="st">"#009E73"</span>, </span>
<span>                                <span class="st">"#56B4E9"</span>, <span class="st">"#CC79A7"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Group"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/bquote.html" class="external-link">bquote</a></span><span class="op">(</span><span class="st">'Mean '</span><span class="op">*</span><span class="va">delta</span><span class="op">^</span><span class="fl">13</span><span class="op">~</span><span class="va">C</span><span class="op">[</span><span class="st">"cor"</span><span class="op">]</span><span class="op">*</span><span class="st">''</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position<span class="op">=</span><span class="st">"none"</span><span class="op">)</span></span>
<span><span class="va">D13C_group</span></span></code></pre></div>
<p><img src="060_Statistical_models_isotopes_files/figure-html/corresponding%20figures%20for%20D13C-1.png" width="700"></p>
<div class="sourceCode" id="cb221"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Figure with crayfish presence</span></span>
<span><span class="va">D13C_crayfish</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">Pop_dataset</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">D13Cavg</span>, </span>
<span>                              x <span class="op">=</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/is.bool.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">Crayfish01</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></span><span class="op">(</span>show.legend <span class="op">=</span> <span class="cn">F</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html" class="external-link">geom_jitter</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col <span class="op">=</span> <span class="va">Species</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">2</span>, show.legend <span class="op">=</span> <span class="cn">F</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#0072B2"</span>, <span class="st">"#009E73"</span>, </span>
<span>                                <span class="st">"#56B4E9"</span>, <span class="st">"#CC79A7"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Crayfish"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">D13C_crayfish</span></span></code></pre></div>
<p><img src="060_Statistical_models_isotopes_files/figure-html/corresponding%20figures%20for%20D13C-2.png" width="700"></p>
<div class="sourceCode" id="cb222"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Put the 2 figures on a single row</span></span>
<span><span class="va">D13C</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">grid.arrange</a></span><span class="op">(</span><span class="va">D13C_group</span>, <span class="va">D13C_crayfish</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="060_Statistical_models_isotopes_files/figure-html/corresponding%20figures%20for%20D13C-3.png" width="700"></p>
</div>
</div>
<div class="section level3">
<h3 id="figure-3">Figure 3<a class="anchor" aria-label="anchor" href="#figure-3"></a>
</h3>
<p>Finally we assemble all the different metrics on a single figure</p>
<div class="sourceCode" id="cb223"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get the legend</span></span>
<span><span class="va">plotlegend</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">Pop_dataset</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">D13Cavg</span>, </span>
<span>                              x <span class="op">=</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/is.bool.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">Crayfish01</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html" class="external-link">geom_jitter</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col <span class="op">=</span> <span class="va">Species</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#0072B2"</span>, <span class="st">"#009E73"</span>, </span>
<span>                                <span class="st">"#56B4E9"</span>, <span class="st">"#CC79A7"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Crayfish"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position<span class="op">=</span><span class="st">"bottom"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://wilkelab.org/cowplot/reference/ggdraw.html" class="external-link">ggdraw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://wilkelab.org/cowplot/reference/draw_plot.html" class="external-link">draw_plot</a></span><span class="op">(</span><span class="va">SEAc</span>, x <span class="op">=</span> <span class="fl">0</span>, y <span class="op">=</span> <span class="fl">0.7</span>, width <span class="op">=</span> <span class="fl">1</span>, height <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://wilkelab.org/cowplot/reference/draw_plot.html" class="external-link">draw_plot</a></span><span class="op">(</span><span class="va">TP</span>, <span class="fl">0</span>, <span class="fl">0.4</span>, <span class="fl">1</span>, <span class="fl">.3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://wilkelab.org/cowplot/reference/draw_plot.html" class="external-link">draw_plot</a></span><span class="op">(</span><span class="va">D13C</span>, <span class="fl">0</span>, <span class="fl">0.1</span>, <span class="fl">1</span>, <span class="fl">0.3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://wilkelab.org/cowplot/reference/draw_plot.html" class="external-link">draw_plot</a></span><span class="op">(</span><span class="fu">cowplot</span><span class="fu">::</span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/get_legend.html" class="external-link">get_legend</a></span><span class="op">(</span><span class="va">plotlegend</span><span class="op">)</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0.1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://wilkelab.org/cowplot/reference/draw_plot_label.html" class="external-link">draw_plot_label</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span><span class="op">)</span>,</span>
<span>                  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>                  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.7</span>, <span class="fl">0.4</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in get_plot_component(plot, "guide-box"): Multiple components found;</span></span>
<span><span class="co">## returning the first one. To return all, use `return_all = TRUE`.</span></span></code></pre>
<div class="sourceCode" id="cb225"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">g</span></span></code></pre></div>
<p><img src="060_Statistical_models_isotopes_files/figure-html/figure%203-1.png" width="700"></p>
<div class="sourceCode" id="cb226"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"figures"</span>, <span class="st">"Figure3c.jpg"</span><span class="op">)</span>, <span class="va">g</span>, width <span class="op">=</span> <span class="fl">8</span>, height <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="footnotes footnotes-end-of-document">
<hr>
<ol>
<li id="fn1"><p>UMR EcoBio, UMR DECOD, <a href="mailto:nadege.belouard@gmail.com" class="email">nadege.belouard@gmail.com</a><a href="#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Nadège Belouard.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
